WARNING: The requested image's platform (linux/amd64) does not match the detected host platform (linux/arm64/v8) and no specific platform was requested
==========================================
AnkleAlign Pipeline
==========================================

Step 1: Running data processing...
============================================================
AnkleAlign Data Processing
============================================================
============================================================
CONFIGURATION
============================================================

[Paths]
  Data directory: /data
  Output directory: /app/output
  Models directory: /app/output/models
  Consensus directory: /data/anklealign/anklealign/consensus

[Training Hyperparameters]
  Number of epochs: 50
  Batch size: 32
  Learning rate: 0.0001
  Early stopping patience: 10
  Number of workers: 0
  Image size: 224x224

[Model Configuration]
  Model: resnet18
  Pretrained: True
  Number of classes: 3

[Data Split Ratios]
  Train: 70%
  Validation: 15%
  Test: 15%
  Random state: 42

[Classes]
  0: 1_Pronacio -> Pronacio
  1: 2_Neutralis -> Neutralis
  2: 3_Szupinacio -> Szupinacio
============================================================
Scanning for images in /data...
Found 331 image files
Found 21 consensus JSON files
Warning: Could not parse /data/anklealign/anklealign/consensus/DPMC6W.json
Warning: Could not find image for be76db85-193684925-back-view-of-a-woman-s-bare-feet-and-high-heels-on-a-white-s_2wddlwB.jpg
Warning: Could not find image for b97d6010-sajat_reszvevo02_01_D6AE9F_D6AE9F.jpg
Warning: Could not find image for 0fb63311-sajat_reszvevo03_01_D6AE9F_D6AE9F.jpg
Warning: Could not find image for bd84e4cb-sajat_reszvevo03_02_D6AE9F_D6AE9F.jpg
Warning: Could not find image for 60b0793e-sajat_reszvevo03_04_D6AE9F_D6AE9F.jpg
Warning: Could not parse /data/anklealign/anklealign/consensus/ITWQ3V.json
Warning: Could not find image for ee5a9d01-sajat_reszvevo01_01_2.jpg
Warning: Could not find image for 239dbcc2-sajat_reszvevo01_02_2.jpg
Warning: Could not find image for ef3c0285-sajat_reszvevo01_03_2.jpg
Warning: Could not find image for c39d1eda-sajat_reszvevo02_01_2.jpg
Warning: Could not find image for 12a7b640-193684925-back-view-of-a-woman-s-bare-feet-and-high-heels-on-a-white-s_vS6AjQR.jpg

Total samples with resolved images: 965

Class distribution:
label_name
2_Neutralis     640
1_Pronacio      230
3_Szupinacio     95
Name: count, dtype: int64

Split sizes:
  Train: 675 (69.9%)
  Val:   145 (15.0%)
  Test:  145 (15.0%)

Class distribution per split:
label_name  1_Pronacio  2_Neutralis  3_Szupinacio
split                                            
test                35           96            14
train              161          448            66
val                 34           96            15

Dataset manifest saved to /app/output/dataset_manifest.csv
Class info saved to /app/output/class_info.json

============================================================
Data processing completed successfully!
============================================================

Step 2: Running model training...
Downloading: "https://download.pytorch.org/models/resnet18-f37072fd.pth" to /root/.cache/torch/hub/checkpoints/resnet18-f37072fd.pth

============================================================
TRAINING
============================================================
============================================================
CONFIGURATION
============================================================

[Paths]
  Data directory: /data
  Output directory: /app/output
  Models directory: /app/output/models
  Consensus directory: /data/anklealign/anklealign/consensus

[Training Hyperparameters]
  Number of epochs: 50
  Batch size: 32
  Learning rate: 0.0001
  Early stopping patience: 10
  Number of workers: 0
  Image size: 224x224

[Model Configuration]
  Model: resnet18
  Pretrained: True
  Number of classes: 3

[Data Split Ratios]
  Train: 70%
  Validation: 15%
  Test: 15%
  Random state: 42

[Classes]
  0: 1_Pronacio -> Pronacio
  1: 2_Neutralis -> Neutralis
  2: 3_Szupinacio -> Szupinacio
============================================================

Loaded manifest with 965 samples

============================================================
DATA SUMMARY
============================================================

[Dataset Splits]
  Training samples:   675 (69.9%)
  Validation samples: 145 (15.0%)
  Test samples:       145 (15.0%)
  Total samples:      965

[Class Distribution]

  Train:
    2_Neutralis: 448
    1_Pronacio: 161
    3_Szupinacio: 66

  Validation:
    2_Neutralis: 96
    1_Pronacio: 34
    3_Szupinacio: 15

  Test:
    2_Neutralis: 96
    1_Pronacio: 35
    3_Szupinacio: 14
============================================================


[Device Information]
  Using: CPU
  0%|          | 0.00/44.7M [00:00<?, ?B/s]  0%|          | 192k/44.7M [00:00<00:23, 1.97MB/s]  2%|▏         | 912k/44.7M [00:00<00:08, 5.14MB/s] 10%|█         | 4.48M/44.7M [00:00<00:02, 19.9MB/s] 23%|██▎       | 10.2M/44.7M [00:00<00:01, 35.1MB/s] 31%|███▏      | 14.0M/44.7M [00:00<00:00, 37.0MB/s] 45%|████▌     | 20.1M/44.7M [00:00<00:00, 46.1MB/s] 55%|█████▍    | 24.5M/44.7M [00:00<00:00, 44.4MB/s] 64%|██████▍   | 28.8M/44.7M [00:00<00:00, 44.0MB/s] 78%|███████▊  | 35.0M/44.7M [00:00<00:00, 50.4MB/s] 89%|████████▉ | 39.9M/44.7M [00:01<00:00, 44.5MB/s]100%|██████████| 44.7M/44.7M [00:01<00:00, 40.9MB/s]
Training:   0%|          | 0/22 [00:00<?, ?it/s]
============================================================
MODEL ARCHITECTURE SUMMARY
============================================================

Model: resnet18 (pretrained=True)

[Architecture]
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(7, 7), stride=(2, 2), padding=(3, 3), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (relu): ReLU(inplace=True)
  (maxpool): MaxPool2d(kernel_size=3, stride=2, padding=1, dilation=1, ceil_mode=False)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (relu): ReLU(inplace=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (relu): ReLU(inplace=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (relu): ReLU(inplace=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (downsample): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (relu): ReLU(inplace=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (relu): ReLU(inplace=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (downsample): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (relu): ReLU(inplace=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (relu): ReLU(inplace=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (downsample): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (relu): ReLU(inplace=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
  )
  (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
  (fc): Linear(in_features=512, out_features=3, bias=True)
)

[Parameter Counts]
  Trainable parameters:     11,178,051
  Non-trainable parameters: 0
  Total parameters:         11,178,051

  Model size (approx):      42.64 MB (float32)
============================================================


Starting training for 50 epochs...
------------------------------------------------------------

Epoch 1/50
Training:   0%|          | 0/22 [00:05<?, ?it/s, loss=0.955, acc=56.2]Training:   5%|▍         | 1/22 [00:05<01:53,  5.43s/it, loss=0.955, acc=56.2]Training:   5%|▍         | 1/22 [00:10<01:53,  5.43s/it, loss=0.967, acc=57.8]Training:   9%|▉         | 2/22 [00:10<01:49,  5.47s/it, loss=0.967, acc=57.8]Training:   9%|▉         | 2/22 [00:15<01:49,  5.47s/it, loss=0.925, acc=57.3]Training:  14%|█▎        | 3/22 [00:15<01:35,  5.03s/it, loss=0.925, acc=57.3]Training:  14%|█▎        | 3/22 [00:21<01:35,  5.03s/it, loss=0.889, acc=60.9]Training:  18%|█▊        | 4/22 [00:21<01:36,  5.38s/it, loss=0.889, acc=60.9]Training:  18%|█▊        | 4/22 [00:26<01:36,  5.38s/it, loss=0.859, acc=61.2]Training:  23%|██▎       | 5/22 [00:26<01:32,  5.44s/it, loss=0.859, acc=61.2]Training:  23%|██▎       | 5/22 [00:31<01:32,  5.44s/it, loss=0.906, acc=61.5]Training:  27%|██▋       | 6/22 [00:31<01:20,  5.05s/it, loss=0.906, acc=61.5]Training:  27%|██▋       | 6/22 [00:36<01:20,  5.05s/it, loss=1.14, acc=60.3] Training:  32%|███▏      | 7/22 [00:36<01:18,  5.20s/it, loss=1.14, acc=60.3]Training:  32%|███▏      | 7/22 [00:40<01:18,  5.20s/it, loss=0.768, acc=61.3]Training:  36%|███▋      | 8/22 [00:40<01:07,  4.81s/it, loss=0.768, acc=61.3]Training:  36%|███▋      | 8/22 [00:44<01:07,  4.81s/it, loss=0.798, acc=62.8]Training:  41%|████      | 9/22 [00:44<00:59,  4.56s/it, loss=0.798, acc=62.8]Training:  41%|████      | 9/22 [00:48<00:59,  4.56s/it, loss=0.949, acc=62.8]Training:  45%|████▌     | 10/22 [00:48<00:51,  4.30s/it, loss=0.949, acc=62.8]Training:  45%|████▌     | 10/22 [00:51<00:51,  4.30s/it, loss=0.803, acc=63.6]Training:  50%|█████     | 11/22 [00:51<00:43,  4.00s/it, loss=0.803, acc=63.6]Training:  50%|█████     | 11/22 [00:57<00:43,  4.00s/it, loss=0.695, acc=64.3]Training:  55%|█████▍    | 12/22 [00:57<00:44,  4.41s/it, loss=0.695, acc=64.3]Training:  55%|█████▍    | 12/22 [01:01<00:44,  4.41s/it, loss=0.815, acc=64.7]Training:  59%|█████▉    | 13/22 [01:01<00:39,  4.36s/it, loss=0.815, acc=64.7]Training:  59%|█████▉    | 13/22 [01:07<00:39,  4.36s/it, loss=1.15, acc=64.3] Training:  64%|██████▎   | 14/22 [01:07<00:38,  4.80s/it, loss=1.15, acc=64.3]Training:  64%|██████▎   | 14/22 [01:13<00:38,  4.80s/it, loss=0.799, acc=64.2]Training:  68%|██████▊   | 15/22 [01:13<00:36,  5.20s/it, loss=0.799, acc=64.2]Training:  68%|██████▊   | 15/22 [01:18<00:36,  5.20s/it, loss=0.744, acc=64.6]Training:  73%|███████▎  | 16/22 [01:18<00:31,  5.19s/it, loss=0.744, acc=64.6]Training:  73%|███████▎  | 16/22 [01:22<00:31,  5.19s/it, loss=0.974, acc=64.5]Training:  77%|███████▋  | 17/22 [01:22<00:24,  4.92s/it, loss=0.974, acc=64.5]Training:  77%|███████▋  | 17/22 [01:28<00:24,  4.92s/it, loss=0.731, acc=64.8]Training:  82%|████████▏ | 18/22 [01:28<00:20,  5.05s/it, loss=0.731, acc=64.8]Training:  82%|████████▏ | 18/22 [01:32<00:20,  5.05s/it, loss=0.979, acc=64.8]Training:  86%|████████▋ | 19/22 [01:32<00:14,  4.77s/it, loss=0.979, acc=64.8]Training:  86%|████████▋ | 19/22 [01:37<00:14,  4.77s/it, loss=0.865, acc=64.4]Training:  91%|█████████ | 20/22 [01:37<00:09,  4.92s/it, loss=0.865, acc=64.4]Training:  91%|█████████ | 20/22 [01:41<00:09,  4.92s/it, loss=0.93, acc=64]   Training:  95%|█████████▌| 21/22 [01:41<00:04,  4.78s/it, loss=0.93, acc=64]Training:  95%|█████████▌| 21/22 [01:42<00:04,  4.78s/it, loss=0.43, acc=64.1]Training: 100%|██████████| 22/22 [01:42<00:00,  3.49s/it, loss=0.43, acc=64.1]                                                                              Validating:   0%|          | 0/5 [00:00<?, ?it/s]Validating:  20%|██        | 1/5 [00:03<00:14,  3.56s/it]Validating:  40%|████      | 2/5 [00:06<00:09,  3.07s/it]Validating:  60%|██████    | 3/5 [00:09<00:06,  3.23s/it]Validating:  80%|████████  | 4/5 [00:12<00:03,  3.09s/it]Validating: 100%|██████████| 5/5 [00:13<00:00,  2.46s/it]                                                         Train Loss: 0.8856, Train Acc: 64.15%
Val Loss: 0.9013, Val Acc: 66.21%
New best model saved! Val Acc: 66.21%

Epoch 2/50
Training:   0%|          | 0/22 [00:00<?, ?it/s]Training:   0%|          | 0/22 [00:05<?, ?it/s, loss=0.969, acc=59.4]Training:   5%|▍         | 1/22 [00:05<01:47,  5.12s/it, loss=0.969, acc=59.4]Training:   5%|▍         | 1/22 [00:10<01:47,  5.12s/it, loss=0.864, acc=64.1]Training:   9%|▉         | 2/22 [00:10<01:39,  4.98s/it, loss=0.864, acc=64.1]Training:   9%|▉         | 2/22 [00:14<01:39,  4.98s/it, loss=0.771, acc=66.7]Training:  14%|█▎        | 3/22 [00:14<01:32,  4.86s/it, loss=0.771, acc=66.7]Training:  14%|█▎        | 3/22 [00:19<01:32,  4.86s/it, loss=0.594, acc=69.5]Training:  18%|█▊        | 4/22 [00:19<01:25,  4.75s/it, loss=0.594, acc=69.5]Training:  18%|█▊        | 4/22 [00:23<01:25,  4.75s/it, loss=0.502, acc=71.2]Training:  23%|██▎       | 5/22 [00:23<01:15,  4.42s/it, loss=0.502, acc=71.2]Training:  23%|██▎       | 5/22 [00:29<01:15,  4.42s/it, loss=0.803, acc=69.8]Training:  27%|██▋       | 6/22 [00:29<01:20,  5.01s/it, loss=0.803, acc=69.8]Training:  27%|██▋       | 6/22 [00:34<01:20,  5.01s/it, loss=0.801, acc=68.8]Training:  32%|███▏      | 7/22 [00:34<01:17,  5.18s/it, loss=0.801, acc=68.8]Training:  32%|███▏      | 7/22 [00:39<01:17,  5.18s/it, loss=0.743, acc=69.9]Training:  36%|███▋      | 8/22 [00:39<01:11,  5.08s/it, loss=0.743, acc=69.9]Training:  36%|███▋      | 8/22 [00:44<01:11,  5.08s/it, loss=0.629, acc=70.5]Training:  41%|████      | 9/22 [00:44<01:04,  4.99s/it, loss=0.629, acc=70.5]Training:  41%|████      | 9/22 [00:49<01:04,  4.99s/it, loss=0.722, acc=70.3]Training:  45%|████▌     | 10/22 [00:49<01:00,  5.00s/it, loss=0.722, acc=70.3]Training:  45%|████▌     | 10/22 [00:53<01:00,  5.00s/it, loss=0.627, acc=70.2]Training:  50%|█████     | 11/22 [00:53<00:50,  4.58s/it, loss=0.627, acc=70.2]Training:  50%|█████     | 11/22 [00:57<00:50,  4.58s/it, loss=0.721, acc=70.1]Training:  55%|█████▍    | 12/22 [00:57<00:44,  4.46s/it, loss=0.721, acc=70.1]Training:  55%|█████▍    | 12/22 [01:02<00:44,  4.46s/it, loss=0.716, acc=69.7]Training:  59%|█████▉    | 13/22 [01:02<00:42,  4.75s/it, loss=0.716, acc=69.7]Training:  59%|█████▉    | 13/22 [01:07<00:42,  4.75s/it, loss=0.861, acc=69.6]Training:  64%|██████▎   | 14/22 [01:07<00:38,  4.78s/it, loss=0.861, acc=69.6]Training:  64%|██████▎   | 14/22 [01:13<00:38,  4.78s/it, loss=0.754, acc=69.8]Training:  68%|██████▊   | 15/22 [01:13<00:34,  4.97s/it, loss=0.754, acc=69.8]Training:  68%|██████▊   | 15/22 [01:17<00:34,  4.97s/it, loss=0.775, acc=69.5]Training:  73%|███████▎  | 16/22 [01:17<00:29,  4.87s/it, loss=0.775, acc=69.5]Training:  73%|███████▎  | 16/22 [01:22<00:29,  4.87s/it, loss=0.667, acc=69.7]Training:  77%|███████▋  | 17/22 [01:22<00:24,  4.86s/it, loss=0.667, acc=69.7]Training:  77%|███████▋  | 17/22 [01:26<00:24,  4.86s/it, loss=0.82, acc=69.6] Training:  82%|████████▏ | 18/22 [01:26<00:18,  4.72s/it, loss=0.82, acc=69.6]Training:  82%|████████▏ | 18/22 [01:33<00:18,  4.72s/it, loss=0.554, acc=70.1]Training:  86%|████████▋ | 19/22 [01:33<00:15,  5.22s/it, loss=0.554, acc=70.1]Training:  86%|████████▋ | 19/22 [01:37<00:15,  5.22s/it, loss=0.804, acc=70.3]Training:  91%|█████████ | 20/22 [01:37<00:10,  5.07s/it, loss=0.804, acc=70.3]Training:  91%|█████████ | 20/22 [01:42<00:10,  5.07s/it, loss=0.707, acc=70.1]Training:  95%|█████████▌| 21/22 [01:42<00:05,  5.05s/it, loss=0.707, acc=70.1]Training:  95%|█████████▌| 21/22 [01:43<00:05,  5.05s/it, loss=1.39, acc=69.9] Training: 100%|██████████| 22/22 [01:43<00:00,  3.65s/it, loss=1.39, acc=69.9]                                                                              Validating:   0%|          | 0/5 [00:00<?, ?it/s]Validating:  20%|██        | 1/5 [00:03<00:14,  3.58s/it]Validating:  40%|████      | 2/5 [00:06<00:09,  3.08s/it]Validating:  60%|██████    | 3/5 [00:09<00:06,  3.24s/it]Validating:  80%|████████  | 4/5 [00:12<00:03,  3.06s/it]Validating: 100%|██████████| 5/5 [00:13<00:00,  2.39s/it]                                                         Train Loss: 0.7364, Train Acc: 69.93%
Val Loss: 0.9179, Val Acc: 65.52%
No improvement for 1 epochs

Epoch 3/50
Training:   0%|          | 0/22 [00:00<?, ?it/s]Training:   0%|          | 0/22 [00:04<?, ?it/s, loss=0.491, acc=84.4]Training:   5%|▍         | 1/22 [00:04<01:28,  4.23s/it, loss=0.491, acc=84.4]Training:   5%|▍         | 1/22 [00:08<01:28,  4.23s/it, loss=0.603, acc=75]  Training:   9%|▉         | 2/22 [00:08<01:28,  4.44s/it, loss=0.603, acc=75]Training:   9%|▉         | 2/22 [00:13<01:28,  4.44s/it, loss=0.727, acc=74]Training:  14%|█▎        | 3/22 [00:13<01:29,  4.70s/it, loss=0.727, acc=74]Training:  14%|█▎        | 3/22 [00:20<01:29,  4.70s/it, loss=0.975, acc=71.9]Training:  18%|█▊        | 4/22 [00:20<01:39,  5.52s/it, loss=0.975, acc=71.9]Training:  18%|█▊        | 4/22 [00:26<01:39,  5.52s/it, loss=0.741, acc=71.2]Training:  23%|██▎       | 5/22 [00:26<01:36,  5.69s/it, loss=0.741, acc=71.2]Training:  23%|██▎       | 5/22 [00:32<01:36,  5.69s/it, loss=0.673, acc=71.4]Training:  27%|██▋       | 6/22 [00:32<01:29,  5.60s/it, loss=0.673, acc=71.4]Training:  27%|██▋       | 6/22 [00:37<01:29,  5.60s/it, loss=0.935, acc=71]  Training:  32%|███▏      | 7/22 [00:37<01:24,  5.66s/it, loss=0.935, acc=71]Training:  32%|███▏      | 7/22 [00:43<01:24,  5.66s/it, loss=0.896, acc=69.9]Training:  36%|███▋      | 8/22 [00:43<01:17,  5.54s/it, loss=0.896, acc=69.9]Training:  36%|███▋      | 8/22 [00:47<01:17,  5.54s/it, loss=0.591, acc=70.8]Training:  41%|████      | 9/22 [00:47<01:07,  5.15s/it, loss=0.591, acc=70.8]Training:  41%|████      | 9/22 [00:51<01:07,  5.15s/it, loss=0.87, acc=69.7] Training:  45%|████▌     | 10/22 [00:51<00:57,  4.79s/it, loss=0.87, acc=69.7]Training:  45%|████▌     | 10/22 [00:55<00:57,  4.79s/it, loss=0.741, acc=69.9]Training:  50%|█████     | 11/22 [00:55<00:51,  4.69s/it, loss=0.741, acc=69.9]Training:  50%|█████     | 11/22 [01:02<00:51,  4.69s/it, loss=0.689, acc=70.1]Training:  55%|█████▍    | 12/22 [01:02<00:53,  5.31s/it, loss=0.689, acc=70.1]Training:  55%|█████▍    | 12/22 [01:06<00:53,  5.31s/it, loss=0.536, acc=70.9]Training:  59%|█████▉    | 13/22 [01:06<00:45,  5.05s/it, loss=0.536, acc=70.9]Training:  59%|█████▉    | 13/22 [01:13<00:45,  5.05s/it, loss=0.562, acc=71.4]Training:  64%|██████▎   | 14/22 [01:13<00:42,  5.35s/it, loss=0.562, acc=71.4]Training:  64%|██████▎   | 14/22 [01:20<00:42,  5.35s/it, loss=0.85, acc=71]   Training:  68%|██████▊   | 15/22 [01:20<00:41,  5.94s/it, loss=0.85, acc=71]Training:  68%|██████▊   | 15/22 [01:25<00:41,  5.94s/it, loss=0.711, acc=71.5]Training:  73%|███████▎  | 16/22 [01:25<00:34,  5.69s/it, loss=0.711, acc=71.5]Training:  73%|███████▎  | 16/22 [01:30<00:34,  5.69s/it, loss=0.747, acc=71.1]Training:  77%|███████▋  | 17/22 [01:30<00:27,  5.46s/it, loss=0.747, acc=71.1]Training:  77%|███████▋  | 17/22 [01:37<00:27,  5.46s/it, loss=0.849, acc=70.7]Training:  82%|████████▏ | 18/22 [01:37<00:23,  5.89s/it, loss=0.849, acc=70.7]Training:  82%|████████▏ | 18/22 [01:45<00:23,  5.89s/it, loss=0.876, acc=70.6]Training:  86%|████████▋ | 19/22 [01:45<00:19,  6.65s/it, loss=0.876, acc=70.6]Training:  86%|████████▋ | 19/22 [01:55<00:19,  6.65s/it, loss=0.54, acc=70.9] Training:  91%|█████████ | 20/22 [01:55<00:15,  7.51s/it, loss=0.54, acc=70.9]Training:  91%|█████████ | 20/22 [02:03<00:15,  7.51s/it, loss=0.75, acc=70.7]Training:  95%|█████████▌| 21/22 [02:03<00:07,  7.86s/it, loss=0.75, acc=70.7]Training:  95%|█████████▌| 21/22 [02:04<00:07,  7.86s/it, loss=0.344, acc=70.8]Training: 100%|██████████| 22/22 [02:04<00:00,  5.74s/it, loss=0.344, acc=70.8]                                                                               Validating:   0%|          | 0/5 [00:00<?, ?it/s]Validating:  20%|██        | 1/5 [00:06<00:24,  6.16s/it]Validating:  40%|████      | 2/5 [00:09<00:14,  4.69s/it]Validating:  60%|██████    | 3/5 [00:13<00:08,  4.17s/it]Validating:  80%|████████  | 4/5 [00:16<00:03,  3.62s/it]Validating: 100%|██████████| 5/5 [00:17<00:00,  2.76s/it]                                                         Train Loss: 0.7294, Train Acc: 70.81%
Val Loss: 0.8939, Val Acc: 68.28%
New best model saved! Val Acc: 68.28%

Epoch 4/50
Training:   0%|          | 0/22 [00:00<?, ?it/s]Training:   0%|          | 0/22 [00:04<?, ?it/s, loss=0.869, acc=65.6]Training:   5%|▍         | 1/22 [00:04<01:30,  4.29s/it, loss=0.869, acc=65.6]Training:   5%|▍         | 1/22 [00:09<01:30,  4.29s/it, loss=0.733, acc=64.1]Training:   9%|▉         | 2/22 [00:09<01:32,  4.60s/it, loss=0.733, acc=64.1]Training:   9%|▉         | 2/22 [00:14<01:32,  4.60s/it, loss=0.603, acc=66.7]Training:  14%|█▎        | 3/22 [00:14<01:36,  5.07s/it, loss=0.603, acc=66.7]Training:  14%|█▎        | 3/22 [00:20<01:36,  5.07s/it, loss=0.672, acc=69.5]Training:  18%|█▊        | 4/22 [00:20<01:37,  5.42s/it, loss=0.672, acc=69.5]Training:  18%|█▊        | 4/22 [00:26<01:37,  5.42s/it, loss=0.781, acc=70.6]Training:  23%|██▎       | 5/22 [00:26<01:32,  5.44s/it, loss=0.781, acc=70.6]Training:  23%|██▎       | 5/22 [00:31<01:32,  5.44s/it, loss=0.714, acc=70.8]Training:  27%|██▋       | 6/22 [00:31<01:23,  5.25s/it, loss=0.714, acc=70.8]Training:  27%|██▋       | 6/22 [00:36<01:23,  5.25s/it, loss=0.447, acc=72.8]Training:  32%|███▏      | 7/22 [00:36<01:20,  5.35s/it, loss=0.447, acc=72.8]Training:  32%|███▏      | 7/22 [00:41<01:20,  5.35s/it, loss=0.621, acc=73.8]Training:  36%|███▋      | 8/22 [00:41<01:12,  5.18s/it, loss=0.621, acc=73.8]Training:  36%|███▋      | 8/22 [00:46<01:12,  5.18s/it, loss=0.927, acc=72.2]Training:  41%|████      | 9/22 [00:46<01:08,  5.24s/it, loss=0.927, acc=72.2]Training:  41%|████      | 9/22 [00:52<01:08,  5.24s/it, loss=0.638, acc=72.5]Training:  45%|████▌     | 10/22 [00:52<01:03,  5.28s/it, loss=0.638, acc=72.5]Training:  45%|████▌     | 10/22 [00:56<01:03,  5.28s/it, loss=0.775, acc=71.9]Training:  50%|█████     | 11/22 [00:56<00:53,  4.89s/it, loss=0.775, acc=71.9]Training:  50%|█████     | 11/22 [01:01<00:53,  4.89s/it, loss=1.17, acc=70.6] Training:  55%|█████▍    | 12/22 [01:01<00:48,  4.89s/it, loss=1.17, acc=70.6]Training:  55%|█████▍    | 12/22 [01:06<00:48,  4.89s/it, loss=0.812, acc=70.4]Training:  59%|█████▉    | 13/22 [01:06<00:44,  4.92s/it, loss=0.812, acc=70.4]Training:  59%|█████▉    | 13/22 [01:11<00:44,  4.92s/it, loss=0.812, acc=70.1]Training:  64%|██████▎   | 14/22 [01:11<00:41,  5.19s/it, loss=0.812, acc=70.1]Training:  64%|██████▎   | 14/22 [01:16<00:41,  5.19s/it, loss=0.734, acc=70.2]Training:  68%|██████▊   | 15/22 [01:16<00:34,  4.97s/it, loss=0.734, acc=70.2]Training:  68%|██████▊   | 15/22 [01:21<00:34,  4.97s/it, loss=0.732, acc=70.1]Training:  73%|███████▎  | 16/22 [01:21<00:29,  4.99s/it, loss=0.732, acc=70.1]Training:  73%|███████▎  | 16/22 [01:25<00:29,  4.99s/it, loss=0.57, acc=71]   Training:  77%|███████▋  | 17/22 [01:25<00:24,  4.80s/it, loss=0.57, acc=71]Training:  77%|███████▋  | 17/22 [01:30<00:24,  4.80s/it, loss=0.483, acc=71.7]Training:  82%|████████▏ | 18/22 [01:30<00:18,  4.69s/it, loss=0.483, acc=71.7]Training:  82%|████████▏ | 18/22 [01:34<00:18,  4.69s/it, loss=0.737, acc=71.9]Training:  86%|████████▋ | 19/22 [01:34<00:13,  4.54s/it, loss=0.737, acc=71.9]Training:  86%|████████▋ | 19/22 [01:39<00:13,  4.54s/it, loss=0.757, acc=71.6]Training:  91%|█████████ | 20/22 [01:39<00:09,  4.67s/it, loss=0.757, acc=71.6]Training:  91%|█████████ | 20/22 [01:44<00:09,  4.67s/it, loss=0.718, acc=71.4]Training:  95%|█████████▌| 21/22 [01:44<00:04,  4.84s/it, loss=0.718, acc=71.4]Training:  95%|█████████▌| 21/22 [01:44<00:04,  4.84s/it, loss=0.451, acc=71.6]Training: 100%|██████████| 22/22 [01:44<00:00,  3.50s/it, loss=0.451, acc=71.6]                                                                               Validating:   0%|          | 0/5 [00:00<?, ?it/s]Validating:  20%|██        | 1/5 [00:03<00:14,  3.60s/it]Validating:  40%|████      | 2/5 [00:06<00:09,  3.07s/it]Validating:  60%|██████    | 3/5 [00:09<00:06,  3.22s/it]Validating:  80%|████████  | 4/5 [00:12<00:03,  3.04s/it]Validating: 100%|██████████| 5/5 [00:13<00:00,  2.38s/it]                                                         Train Loss: 0.7278, Train Acc: 71.56%
Val Loss: 0.8591, Val Acc: 68.97%
New best model saved! Val Acc: 68.97%

Epoch 5/50
Training:   0%|          | 0/22 [00:00<?, ?it/s]Training:   0%|          | 0/22 [00:03<?, ?it/s, loss=0.601, acc=75]Training:   5%|▍         | 1/22 [00:03<01:20,  3.83s/it, loss=0.601, acc=75]Training:   5%|▍         | 1/22 [00:09<01:20,  3.83s/it, loss=0.547, acc=79.7]Training:   9%|▉         | 2/22 [00:09<01:43,  5.17s/it, loss=0.547, acc=79.7]Training:   9%|▉         | 2/22 [00:14<01:43,  5.17s/it, loss=0.749, acc=72.9]Training:  14%|█▎        | 3/22 [00:14<01:28,  4.67s/it, loss=0.749, acc=72.9]Training:  14%|█▎        | 3/22 [00:19<01:28,  4.67s/it, loss=0.745, acc=71.1]Training:  18%|█▊        | 4/22 [00:19<01:31,  5.06s/it, loss=0.745, acc=71.1]Training:  18%|█▊        | 4/22 [00:23<01:31,  5.06s/it, loss=0.856, acc=71.9]Training:  23%|██▎       | 5/22 [00:23<01:17,  4.56s/it, loss=0.856, acc=71.9]Training:  23%|██▎       | 5/22 [00:28<01:17,  4.56s/it, loss=0.844, acc=70.8]Training:  27%|██▋       | 6/22 [00:28<01:15,  4.69s/it, loss=0.844, acc=70.8]Training:  27%|██▋       | 6/22 [00:32<01:15,  4.69s/it, loss=0.532, acc=71.9]Training:  32%|███▏      | 7/22 [00:32<01:09,  4.66s/it, loss=0.532, acc=71.9]Training:  32%|███▏      | 7/22 [00:38<01:09,  4.66s/it, loss=0.943, acc=70.3]Training:  36%|███▋      | 8/22 [00:38<01:08,  4.89s/it, loss=0.943, acc=70.3]Training:  36%|███▋      | 8/22 [00:42<01:08,  4.89s/it, loss=0.707, acc=71.2]Training:  41%|████      | 9/22 [00:42<01:02,  4.81s/it, loss=0.707, acc=71.2]Training:  41%|████      | 9/22 [00:48<01:02,  4.81s/it, loss=0.689, acc=71.6]Training:  45%|████▌     | 10/22 [00:48<01:00,  5.03s/it, loss=0.689, acc=71.6]Training:  45%|████▌     | 10/22 [00:52<01:00,  5.03s/it, loss=0.662, acc=71.3]Training:  50%|█████     | 11/22 [00:52<00:52,  4.75s/it, loss=0.662, acc=71.3]Training:  50%|█████     | 11/22 [00:58<00:52,  4.75s/it, loss=0.621, acc=71.1]Training:  55%|█████▍    | 12/22 [00:58<00:50,  5.02s/it, loss=0.621, acc=71.1]Training:  55%|█████▍    | 12/22 [01:03<00:50,  5.02s/it, loss=0.956, acc=70.2]Training:  59%|█████▉    | 13/22 [01:03<00:44,  4.97s/it, loss=0.956, acc=70.2]Training:  59%|█████▉    | 13/22 [01:07<00:44,  4.97s/it, loss=0.597, acc=70.3]Training:  64%|██████▎   | 14/22 [01:07<00:38,  4.87s/it, loss=0.597, acc=70.3]Training:  64%|██████▎   | 14/22 [01:11<00:38,  4.87s/it, loss=0.612, acc=70.6]Training:  68%|██████▊   | 15/22 [01:11<00:31,  4.55s/it, loss=0.612, acc=70.6]Training:  68%|██████▊   | 15/22 [01:16<00:31,  4.55s/it, loss=0.927, acc=70.3]Training:  73%|███████▎  | 16/22 [01:16<00:27,  4.62s/it, loss=0.927, acc=70.3]Training:  73%|███████▎  | 16/22 [01:21<00:27,  4.62s/it, loss=1.04, acc=69.3] Training:  77%|███████▋  | 17/22 [01:21<00:23,  4.77s/it, loss=1.04, acc=69.3]Training:  77%|███████▋  | 17/22 [01:27<00:23,  4.77s/it, loss=0.77, acc=69.3]Training:  82%|████████▏ | 18/22 [01:27<00:20,  5.03s/it, loss=0.77, acc=69.3]Training:  82%|████████▏ | 18/22 [01:33<00:20,  5.03s/it, loss=0.501, acc=69.9]Training:  86%|████████▋ | 19/22 [01:33<00:16,  5.47s/it, loss=0.501, acc=69.9]Training:  86%|████████▋ | 19/22 [01:38<00:16,  5.47s/it, loss=0.858, acc=69.5]Training:  91%|█████████ | 20/22 [01:38<00:10,  5.22s/it, loss=0.858, acc=69.5]Training:  91%|█████████ | 20/22 [01:43<00:10,  5.22s/it, loss=0.916, acc=69.2]Training:  95%|█████████▌| 21/22 [01:43<00:05,  5.21s/it, loss=0.916, acc=69.2]Training:  95%|█████████▌| 21/22 [01:44<00:05,  5.21s/it, loss=0.363, acc=69.3]Training: 100%|██████████| 22/22 [01:44<00:00,  3.86s/it, loss=0.363, acc=69.3]                                                                               Validating:   0%|          | 0/5 [00:00<?, ?it/s]Validating:  20%|██        | 1/5 [00:03<00:14,  3.63s/it]Validating:  40%|████      | 2/5 [00:06<00:09,  3.15s/it]Validating:  60%|██████    | 3/5 [00:09<00:06,  3.33s/it]Validating:  80%|████████  | 4/5 [00:12<00:03,  3.13s/it]Validating: 100%|██████████| 5/5 [00:14<00:00,  2.44s/it]                                                         Train Loss: 0.7448, Train Acc: 69.33%
Val Loss: 0.9657, Val Acc: 68.28%
No improvement for 1 epochs

Epoch 6/50
Training:   0%|          | 0/22 [00:00<?, ?it/s]Training:   0%|          | 0/22 [00:04<?, ?it/s, loss=0.734, acc=65.6]Training:   5%|▍         | 1/22 [00:04<01:42,  4.88s/it, loss=0.734, acc=65.6]Training:   5%|▍         | 1/22 [00:09<01:42,  4.88s/it, loss=0.586, acc=68.8]Training:   9%|▉         | 2/22 [00:09<01:33,  4.68s/it, loss=0.586, acc=68.8]Training:   9%|▉         | 2/22 [00:13<01:33,  4.68s/it, loss=0.788, acc=66.7]Training:  14%|█▎        | 3/22 [00:13<01:21,  4.30s/it, loss=0.788, acc=66.7]Training:  14%|█▎        | 3/22 [00:17<01:21,  4.30s/it, loss=0.819, acc=66.4]Training:  18%|█▊        | 4/22 [00:17<01:18,  4.34s/it, loss=0.819, acc=66.4]Training:  18%|█▊        | 4/22 [00:22<01:18,  4.34s/it, loss=0.594, acc=68.8]Training:  23%|██▎       | 5/22 [00:22<01:16,  4.48s/it, loss=0.594, acc=68.8]Training:  23%|██▎       | 5/22 [00:28<01:16,  4.48s/it, loss=0.812, acc=69.3]Training:  27%|██▋       | 6/22 [00:28<01:19,  4.99s/it, loss=0.812, acc=69.3]Training:  27%|██▋       | 6/22 [00:33<01:19,  4.99s/it, loss=0.645, acc=70.1]Training:  32%|███▏      | 7/22 [00:33<01:13,  4.89s/it, loss=0.645, acc=70.1]Training:  32%|███▏      | 7/22 [00:37<01:13,  4.89s/it, loss=0.527, acc=71.5]Training:  36%|███▋      | 8/22 [00:37<01:05,  4.69s/it, loss=0.527, acc=71.5]Training:  36%|███▋      | 8/22 [00:43<01:05,  4.69s/it, loss=0.764, acc=70.8]Training:  41%|████      | 9/22 [00:43<01:06,  5.12s/it, loss=0.764, acc=70.8]Training:  41%|████      | 9/22 [00:48<01:06,  5.12s/it, loss=0.682, acc=70.6]Training:  45%|████▌     | 10/22 [00:48<01:00,  5.03s/it, loss=0.682, acc=70.6]Training:  45%|████▌     | 10/22 [00:53<01:00,  5.03s/it, loss=0.555, acc=70.7]Training:  50%|█████     | 11/22 [00:53<00:55,  5.03s/it, loss=0.555, acc=70.7]Training:  50%|█████     | 11/22 [00:58<00:55,  5.03s/it, loss=0.715, acc=71.1]Training:  55%|█████▍    | 12/22 [00:58<00:51,  5.13s/it, loss=0.715, acc=71.1]Training:  55%|█████▍    | 12/22 [01:02<00:51,  5.13s/it, loss=0.687, acc=71.4]Training:  59%|█████▉    | 13/22 [01:02<00:42,  4.78s/it, loss=0.687, acc=71.4]Training:  59%|█████▉    | 13/22 [01:08<00:42,  4.78s/it, loss=0.935, acc=70.5]Training:  64%|██████▎   | 14/22 [01:08<00:40,  5.12s/it, loss=0.935, acc=70.5]Training:  64%|██████▎   | 14/22 [01:13<00:40,  5.12s/it, loss=0.828, acc=70.4]Training:  68%|██████▊   | 15/22 [01:13<00:36,  5.16s/it, loss=0.828, acc=70.4]Training:  68%|██████▊   | 15/22 [01:18<00:36,  5.16s/it, loss=0.587, acc=70.3]Training:  73%|███████▎  | 16/22 [01:18<00:29,  4.98s/it, loss=0.587, acc=70.3]Training:  73%|███████▎  | 16/22 [01:23<00:29,  4.98s/it, loss=0.516, acc=71]  Training:  77%|███████▋  | 17/22 [01:23<00:24,  4.90s/it, loss=0.516, acc=71]Training:  77%|███████▋  | 17/22 [01:27<00:24,  4.90s/it, loss=0.702, acc=70.8]Training:  82%|████████▏ | 18/22 [01:27<00:19,  4.76s/it, loss=0.702, acc=70.8]Training:  82%|████████▏ | 18/22 [01:32<00:19,  4.76s/it, loss=0.616, acc=71.4]Training:  86%|████████▋ | 19/22 [01:32<00:14,  4.77s/it, loss=0.616, acc=71.4]Training:  86%|████████▋ | 19/22 [01:36<00:14,  4.77s/it, loss=0.777, acc=71.1]Training:  91%|█████████ | 20/22 [01:36<00:09,  4.60s/it, loss=0.777, acc=71.1]Training:  91%|█████████ | 20/22 [01:41<00:09,  4.60s/it, loss=0.902, acc=71.3]Training:  95%|█████████▌| 21/22 [01:41<00:04,  4.66s/it, loss=0.902, acc=71.3]Training:  95%|█████████▌| 21/22 [01:41<00:04,  4.66s/it, loss=1.11, acc=71.3] Training: 100%|██████████| 22/22 [01:41<00:00,  3.45s/it, loss=1.11, acc=71.3]                                                                              Validating:   0%|          | 0/5 [00:00<?, ?it/s]Validating:  20%|██        | 1/5 [00:03<00:14,  3.60s/it]Validating:  40%|████      | 2/5 [00:06<00:09,  3.06s/it]Validating:  60%|██████    | 3/5 [00:09<00:06,  3.22s/it]Validating:  80%|████████  | 4/5 [00:12<00:03,  3.05s/it]Validating: 100%|██████████| 5/5 [00:13<00:00,  2.38s/it]                                                         Train Loss: 0.7051, Train Acc: 71.26%
Val Loss: 0.9115, Val Acc: 64.14%
No improvement for 2 epochs

Epoch 7/50
Training:   0%|          | 0/22 [00:00<?, ?it/s]Training:   0%|          | 0/22 [00:04<?, ?it/s, loss=0.649, acc=71.9]Training:   5%|▍         | 1/22 [00:04<01:27,  4.16s/it, loss=0.649, acc=71.9]Training:   5%|▍         | 1/22 [00:09<01:27,  4.16s/it, loss=0.821, acc=65.6]Training:   9%|▉         | 2/22 [00:09<01:41,  5.05s/it, loss=0.821, acc=65.6]Training:   9%|▉         | 2/22 [00:14<01:41,  5.05s/it, loss=0.55, acc=68.8] Training:  14%|█▎        | 3/22 [00:14<01:30,  4.76s/it, loss=0.55, acc=68.8]Training:  14%|█▎        | 3/22 [00:20<01:30,  4.76s/it, loss=0.845, acc=68.8]Training:  18%|█▊        | 4/22 [00:20<01:33,  5.21s/it, loss=0.845, acc=68.8]Training:  18%|█▊        | 4/22 [00:24<01:33,  5.21s/it, loss=0.521, acc=71.2]Training:  23%|██▎       | 5/22 [00:24<01:25,  5.03s/it, loss=0.521, acc=71.2]Training:  23%|██▎       | 5/22 [00:29<01:25,  5.03s/it, loss=0.697, acc=71.9]Training:  27%|██▋       | 6/22 [00:29<01:20,  5.04s/it, loss=0.697, acc=71.9]Training:  27%|██▋       | 6/22 [00:35<01:20,  5.04s/it, loss=0.745, acc=71.4]Training:  32%|███▏      | 7/22 [00:35<01:16,  5.10s/it, loss=0.745, acc=71.4]Training:  32%|███▏      | 7/22 [00:39<01:16,  5.10s/it, loss=0.764, acc=70.3]Training:  36%|███▋      | 8/22 [00:39<01:09,  4.94s/it, loss=0.764, acc=70.3]Training:  36%|███▋      | 8/22 [00:43<01:09,  4.94s/it, loss=0.924, acc=70.1]Training:  41%|████      | 9/22 [00:43<01:00,  4.65s/it, loss=0.924, acc=70.1]Training:  41%|████      | 9/22 [00:49<01:00,  4.65s/it, loss=0.617, acc=70.6]Training:  45%|████▌     | 10/22 [00:49<00:58,  4.86s/it, loss=0.617, acc=70.6]Training:  45%|████▌     | 10/22 [00:52<00:58,  4.86s/it, loss=0.658, acc=71.3]Training:  50%|█████     | 11/22 [00:52<00:48,  4.42s/it, loss=0.658, acc=71.3]Training:  50%|█████     | 11/22 [00:57<00:48,  4.42s/it, loss=0.517, acc=71.9]Training:  55%|█████▍    | 12/22 [00:57<00:45,  4.50s/it, loss=0.517, acc=71.9]Training:  55%|█████▍    | 12/22 [01:02<00:45,  4.50s/it, loss=0.861, acc=71.4]Training:  59%|█████▉    | 13/22 [01:02<00:41,  4.66s/it, loss=0.861, acc=71.4]Training:  59%|█████▉    | 13/22 [01:06<00:41,  4.66s/it, loss=0.701, acc=71.2]Training:  64%|██████▎   | 14/22 [01:06<00:35,  4.47s/it, loss=0.701, acc=71.2]Training:  64%|██████▎   | 14/22 [01:11<00:35,  4.47s/it, loss=0.876, acc=70.2]Training:  68%|██████▊   | 15/22 [01:11<00:32,  4.58s/it, loss=0.876, acc=70.2]Training:  68%|██████▊   | 15/22 [01:15<00:32,  4.58s/it, loss=0.532, acc=70.9]Training:  73%|███████▎  | 16/22 [01:15<00:27,  4.63s/it, loss=0.532, acc=70.9]Training:  73%|███████▎  | 16/22 [01:20<00:27,  4.63s/it, loss=0.793, acc=70]  Training:  77%|███████▋  | 17/22 [01:20<00:23,  4.71s/it, loss=0.793, acc=70]Training:  77%|███████▋  | 17/22 [01:24<00:23,  4.71s/it, loss=0.56, acc=70.7]Training:  82%|████████▏ | 18/22 [01:24<00:17,  4.47s/it, loss=0.56, acc=70.7]Training:  82%|████████▏ | 18/22 [01:29<00:17,  4.47s/it, loss=0.472, acc=71.1]Training:  86%|████████▋ | 19/22 [01:29<00:13,  4.58s/it, loss=0.472, acc=71.1]Training:  86%|████████▋ | 19/22 [01:34<00:13,  4.58s/it, loss=0.872, acc=70.9]Training:  91%|█████████ | 20/22 [01:34<00:09,  4.67s/it, loss=0.872, acc=70.9]Training:  91%|█████████ | 20/22 [01:39<00:09,  4.67s/it, loss=0.911, acc=70.7]Training:  95%|█████████▌| 21/22 [01:39<00:04,  4.84s/it, loss=0.911, acc=70.7]Training:  95%|█████████▌| 21/22 [01:39<00:04,  4.84s/it, loss=1.92, acc=70.5] Training: 100%|██████████| 22/22 [01:39<00:00,  3.48s/it, loss=1.92, acc=70.5]                                                                              Validating:   0%|          | 0/5 [00:00<?, ?it/s]Validating:  20%|██        | 1/5 [00:03<00:14,  3.51s/it]Validating:  40%|████      | 2/5 [00:06<00:09,  3.01s/it]Validating:  60%|██████    | 3/5 [00:09<00:06,  3.18s/it]Validating:  80%|████████  | 4/5 [00:12<00:03,  3.00s/it]Validating: 100%|██████████| 5/5 [00:13<00:00,  2.34s/it]                                                         Train Loss: 0.7143, Train Acc: 70.52%
Val Loss: 0.9123, Val Acc: 68.28%
No improvement for 3 epochs

Epoch 8/50
Training:   0%|          | 0/22 [00:00<?, ?it/s]Training:   0%|          | 0/22 [00:04<?, ?it/s, loss=0.705, acc=59.4]Training:   5%|▍         | 1/22 [00:04<01:29,  4.27s/it, loss=0.705, acc=59.4]Training:   5%|▍         | 1/22 [00:08<01:29,  4.27s/it, loss=0.517, acc=70.3]Training:   9%|▉         | 2/22 [00:08<01:23,  4.19s/it, loss=0.517, acc=70.3]Training:   9%|▉         | 2/22 [00:12<01:23,  4.19s/it, loss=0.686, acc=69.8]Training:  14%|█▎        | 3/22 [00:12<01:21,  4.30s/it, loss=0.686, acc=69.8]Training:  14%|█▎        | 3/22 [00:17<01:21,  4.30s/it, loss=0.649, acc=71.1]Training:  18%|█▊        | 4/22 [00:17<01:18,  4.38s/it, loss=0.649, acc=71.1]Training:  18%|█▊        | 4/22 [00:22<01:18,  4.38s/it, loss=0.734, acc=70.6]Training:  23%|██▎       | 5/22 [00:22<01:17,  4.54s/it, loss=0.734, acc=70.6]Training:  23%|██▎       | 5/22 [00:26<01:17,  4.54s/it, loss=0.715, acc=71.4]Training:  27%|██▋       | 6/22 [00:26<01:09,  4.36s/it, loss=0.715, acc=71.4]Training:  27%|██▋       | 6/22 [00:32<01:09,  4.36s/it, loss=1.14, acc=68.3] Training:  32%|███▏      | 7/22 [00:32<01:13,  4.90s/it, loss=1.14, acc=68.3]Training:  32%|███▏      | 7/22 [00:36<01:13,  4.90s/it, loss=0.592, acc=68.4]Training:  36%|███▋      | 8/22 [00:36<01:08,  4.86s/it, loss=0.592, acc=68.4]Training:  36%|███▋      | 8/22 [00:41<01:08,  4.86s/it, loss=0.817, acc=68.8]Training:  41%|████      | 9/22 [00:41<01:00,  4.65s/it, loss=0.817, acc=68.8]Training:  41%|████      | 9/22 [00:47<01:00,  4.65s/it, loss=0.578, acc=69.4]Training:  45%|████▌     | 10/22 [00:47<01:01,  5.08s/it, loss=0.578, acc=69.4]Training:  45%|████▌     | 10/22 [00:52<01:01,  5.08s/it, loss=0.77, acc=69.6] Training:  50%|█████     | 11/22 [00:52<00:56,  5.12s/it, loss=0.77, acc=69.6]Training:  50%|█████     | 11/22 [00:57<00:56,  5.12s/it, loss=0.9, acc=68.8] Training:  55%|█████▍    | 12/22 [00:57<00:49,  4.98s/it, loss=0.9, acc=68.8]Training:  55%|█████▍    | 12/22 [01:00<00:49,  4.98s/it, loss=0.647, acc=69.5]Training:  59%|█████▉    | 13/22 [01:00<00:40,  4.51s/it, loss=0.647, acc=69.5]Training:  59%|█████▉    | 13/22 [01:03<00:40,  4.51s/it, loss=0.844, acc=69.2]Training:  64%|██████▎   | 14/22 [01:03<00:32,  4.01s/it, loss=0.844, acc=69.2]Training:  64%|██████▎   | 14/22 [01:07<00:32,  4.01s/it, loss=0.743, acc=69]  Training:  68%|██████▊   | 15/22 [01:07<00:28,  4.14s/it, loss=0.743, acc=69]Training:  68%|██████▊   | 15/22 [01:11<00:28,  4.14s/it, loss=0.537, acc=69.9]Training:  73%|███████▎  | 16/22 [01:11<00:24,  4.08s/it, loss=0.537, acc=69.9]Training:  73%|███████▎  | 16/22 [01:18<00:24,  4.08s/it, loss=0.763, acc=69.7]Training:  77%|███████▋  | 17/22 [01:18<00:24,  4.99s/it, loss=0.763, acc=69.7]Training:  77%|███████▋  | 17/22 [01:25<00:24,  4.99s/it, loss=0.635, acc=70]  Training:  82%|████████▏ | 18/22 [01:25<00:21,  5.44s/it, loss=0.635, acc=70]Training:  82%|████████▏ | 18/22 [01:29<00:21,  5.44s/it, loss=0.737, acc=70.6]Training:  86%|████████▋ | 19/22 [01:29<00:15,  5.15s/it, loss=0.737, acc=70.6]Training:  86%|████████▋ | 19/22 [01:33<00:15,  5.15s/it, loss=0.85, acc=70.3] Training:  91%|█████████ | 20/22 [01:33<00:09,  4.66s/it, loss=0.85, acc=70.3]Training:  91%|█████████ | 20/22 [01:38<00:09,  4.66s/it, loss=0.697, acc=70.4]Training:  95%|█████████▌| 21/22 [01:38<00:04,  4.91s/it, loss=0.697, acc=70.4]Training:  95%|█████████▌| 21/22 [01:39<00:04,  4.91s/it, loss=0.417, acc=70.4]Training: 100%|██████████| 22/22 [01:39<00:00,  3.63s/it, loss=0.417, acc=70.4]                                                                               Validating:   0%|          | 0/5 [00:00<?, ?it/s]Validating:  20%|██        | 1/5 [00:03<00:14,  3.56s/it]Validating:  40%|████      | 2/5 [00:06<00:09,  3.05s/it]Validating:  60%|██████    | 3/5 [00:09<00:06,  3.21s/it]Validating:  80%|████████  | 4/5 [00:12<00:03,  3.03s/it]Validating: 100%|██████████| 5/5 [00:13<00:00,  2.37s/it]                                                         Train Loss: 0.7251, Train Acc: 70.37%
Val Loss: 0.9735, Val Acc: 65.52%
No improvement for 4 epochs

Epoch 9/50
Training:   0%|          | 0/22 [00:00<?, ?it/s]Training:   0%|          | 0/22 [00:04<?, ?it/s, loss=0.748, acc=75]Training:   5%|▍         | 1/22 [00:04<01:38,  4.71s/it, loss=0.748, acc=75]Training:   5%|▍         | 1/22 [00:10<01:38,  4.71s/it, loss=0.776, acc=71.9]Training:   9%|▉         | 2/22 [00:10<01:41,  5.06s/it, loss=0.776, acc=71.9]Training:   9%|▉         | 2/22 [00:14<01:41,  5.06s/it, loss=0.613, acc=71.9]Training:  14%|█▎        | 3/22 [00:14<01:33,  4.91s/it, loss=0.613, acc=71.9]Training:  14%|█▎        | 3/22 [00:18<01:33,  4.91s/it, loss=0.611, acc=71.9]Training:  18%|█▊        | 4/22 [00:18<01:20,  4.50s/it, loss=0.611, acc=71.9]Training:  18%|█▊        | 4/22 [00:23<01:20,  4.50s/it, loss=0.645, acc=72.5]Training:  23%|██▎       | 5/22 [00:23<01:16,  4.49s/it, loss=0.645, acc=72.5]Training:  23%|██▎       | 5/22 [00:28<01:16,  4.49s/it, loss=0.494, acc=73.4]Training:  27%|██▋       | 6/22 [00:28<01:14,  4.66s/it, loss=0.494, acc=73.4]Training:  27%|██▋       | 6/22 [00:33<01:14,  4.66s/it, loss=0.704, acc=73.2]Training:  32%|███▏      | 7/22 [00:33<01:15,  5.05s/it, loss=0.704, acc=73.2]Training:  32%|███▏      | 7/22 [00:39<01:15,  5.05s/it, loss=0.525, acc=74.2]Training:  36%|███▋      | 8/22 [00:39<01:11,  5.07s/it, loss=0.525, acc=74.2]Training:  36%|███▋      | 8/22 [00:43<01:11,  5.07s/it, loss=0.64, acc=73.6] Training:  41%|████      | 9/22 [00:43<01:04,  4.97s/it, loss=0.64, acc=73.6]Training:  41%|████      | 9/22 [00:47<01:04,  4.97s/it, loss=0.879, acc=73.1]Training:  45%|████▌     | 10/22 [00:47<00:56,  4.68s/it, loss=0.879, acc=73.1]Training:  45%|████▌     | 10/22 [00:52<00:56,  4.68s/it, loss=0.651, acc=73.6]Training:  50%|█████     | 11/22 [00:52<00:50,  4.59s/it, loss=0.651, acc=73.6]Training:  50%|█████     | 11/22 [00:56<00:50,  4.59s/it, loss=0.921, acc=72.9]Training:  55%|█████▍    | 12/22 [00:56<00:45,  4.58s/it, loss=0.921, acc=72.9]Training:  55%|█████▍    | 12/22 [01:00<00:45,  4.58s/it, loss=0.714, acc=73.1]Training:  59%|█████▉    | 13/22 [01:00<00:39,  4.36s/it, loss=0.714, acc=73.1]Training:  59%|█████▉    | 13/22 [01:05<00:39,  4.36s/it, loss=0.537, acc=73]  Training:  64%|██████▎   | 14/22 [01:05<00:35,  4.49s/it, loss=0.537, acc=73]Training:  64%|██████▎   | 14/22 [01:10<00:35,  4.49s/it, loss=0.834, acc=72.7]Training:  68%|██████▊   | 15/22 [01:10<00:32,  4.59s/it, loss=0.834, acc=72.7]Training:  68%|██████▊   | 15/22 [01:14<00:32,  4.59s/it, loss=1.07, acc=71.5] Training:  73%|███████▎  | 16/22 [01:14<00:27,  4.56s/it, loss=1.07, acc=71.5]Training:  73%|███████▎  | 16/22 [01:18<00:27,  4.56s/it, loss=0.839, acc=71.3]Training:  77%|███████▋  | 17/22 [01:18<00:22,  4.43s/it, loss=0.839, acc=71.3]Training:  77%|███████▋  | 17/22 [01:22<00:22,  4.43s/it, loss=0.669, acc=71.7]Training:  82%|████████▏ | 18/22 [01:22<00:16,  4.20s/it, loss=0.669, acc=71.7]Training:  82%|████████▏ | 18/22 [01:27<00:16,  4.20s/it, loss=0.856, acc=71.5]Training:  86%|████████▋ | 19/22 [01:27<00:13,  4.55s/it, loss=0.856, acc=71.5]Training:  86%|████████▋ | 19/22 [01:32<00:13,  4.55s/it, loss=0.631, acc=71.7]Training:  91%|█████████ | 20/22 [01:32<00:09,  4.71s/it, loss=0.631, acc=71.7]Training:  91%|█████████ | 20/22 [01:39<00:09,  4.71s/it, loss=0.511, acc=72]  Training:  95%|█████████▌| 21/22 [01:39<00:05,  5.22s/it, loss=0.511, acc=72]Training:  95%|█████████▌| 21/22 [01:39<00:05,  5.22s/it, loss=1.02, acc=71.9]Training: 100%|██████████| 22/22 [01:39<00:00,  3.75s/it, loss=1.02, acc=71.9]                                                                              Validating:   0%|          | 0/5 [00:00<?, ?it/s]Validating:  20%|██        | 1/5 [00:03<00:14,  3.65s/it]Validating:  40%|████      | 2/5 [00:06<00:09,  3.11s/it]Validating:  60%|██████    | 3/5 [00:09<00:06,  3.24s/it]Validating:  80%|████████  | 4/5 [00:12<00:03,  3.08s/it]Validating: 100%|██████████| 5/5 [00:13<00:00,  2.40s/it]                                                         Train Loss: 0.7094, Train Acc: 71.85%
Val Loss: 0.9526, Val Acc: 64.83%
No improvement for 5 epochs

Epoch 10/50
Training:   0%|          | 0/22 [00:00<?, ?it/s]Training:   0%|          | 0/22 [00:04<?, ?it/s, loss=0.511, acc=75]Training:   5%|▍         | 1/22 [00:04<01:33,  4.44s/it, loss=0.511, acc=75]Training:   5%|▍         | 1/22 [00:08<01:33,  4.44s/it, loss=0.759, acc=68.8]Training:   9%|▉         | 2/22 [00:08<01:25,  4.27s/it, loss=0.759, acc=68.8]Training:   9%|▉         | 2/22 [00:13<01:25,  4.27s/it, loss=0.73, acc=64.6] Training:  14%|█▎        | 3/22 [00:13<01:29,  4.70s/it, loss=0.73, acc=64.6]Training:  14%|█▎        | 3/22 [00:18<01:29,  4.70s/it, loss=0.734, acc=64.8]Training:  18%|█▊        | 4/22 [00:18<01:25,  4.76s/it, loss=0.734, acc=64.8]Training:  18%|█▊        | 4/22 [00:23<01:25,  4.76s/it, loss=0.849, acc=63.8]Training:  23%|██▎       | 5/22 [00:23<01:22,  4.83s/it, loss=0.849, acc=63.8]Training:  23%|██▎       | 5/22 [00:28<01:22,  4.83s/it, loss=0.767, acc=65.1]Training:  27%|██▋       | 6/22 [00:28<01:15,  4.72s/it, loss=0.767, acc=65.1]Training:  27%|██▋       | 6/22 [00:32<01:15,  4.72s/it, loss=0.704, acc=65.2]Training:  32%|███▏      | 7/22 [00:32<01:09,  4.65s/it, loss=0.704, acc=65.2]Training:  32%|███▏      | 7/22 [00:37<01:09,  4.65s/it, loss=0.759, acc=65.6]Training:  36%|███▋      | 8/22 [00:37<01:04,  4.62s/it, loss=0.759, acc=65.6]Training:  36%|███▋      | 8/22 [00:42<01:04,  4.62s/it, loss=0.536, acc=66.7]Training:  41%|████      | 9/22 [00:42<01:01,  4.70s/it, loss=0.536, acc=66.7]Training:  41%|████      | 9/22 [00:45<01:01,  4.70s/it, loss=0.71, acc=67.5] Training:  45%|████▌     | 10/22 [00:45<00:53,  4.47s/it, loss=0.71, acc=67.5]Training:  45%|████▌     | 10/22 [00:51<00:53,  4.47s/it, loss=0.73, acc=67.3]Training:  50%|█████     | 11/22 [00:51<00:54,  4.92s/it, loss=0.73, acc=67.3]Training:  50%|█████     | 11/22 [00:56<00:54,  4.92s/it, loss=1.02, acc=65.9]Training:  55%|█████▍    | 12/22 [00:56<00:47,  4.79s/it, loss=1.02, acc=65.9]Training:  55%|█████▍    | 12/22 [01:01<00:47,  4.79s/it, loss=0.729, acc=65.9]Training:  59%|█████▉    | 13/22 [01:01<00:44,  4.90s/it, loss=0.729, acc=65.9]Training:  59%|█████▉    | 13/22 [01:07<00:44,  4.90s/it, loss=0.751, acc=66.5]Training:  64%|██████▎   | 14/22 [01:07<00:40,  5.07s/it, loss=0.751, acc=66.5]Training:  64%|██████▎   | 14/22 [01:12<00:40,  5.07s/it, loss=0.721, acc=66.7]Training:  68%|██████▊   | 15/22 [01:12<00:36,  5.25s/it, loss=0.721, acc=66.7]Training:  68%|██████▊   | 15/22 [01:17<00:36,  5.25s/it, loss=0.839, acc=66.6]Training:  73%|███████▎  | 16/22 [01:17<00:30,  5.01s/it, loss=0.839, acc=66.6]Training:  73%|███████▎  | 16/22 [01:22<00:30,  5.01s/it, loss=0.764, acc=66.5]Training:  77%|███████▋  | 17/22 [01:22<00:25,  5.13s/it, loss=0.764, acc=66.5]Training:  77%|███████▋  | 17/22 [01:27<00:25,  5.13s/it, loss=0.843, acc=66.5]Training:  82%|████████▏ | 18/22 [01:27<00:20,  5.15s/it, loss=0.843, acc=66.5]Training:  82%|████████▏ | 18/22 [01:32<00:20,  5.15s/it, loss=0.72, acc=66.6] Training:  86%|████████▋ | 19/22 [01:32<00:15,  5.17s/it, loss=0.72, acc=66.6]Training:  86%|████████▋ | 19/22 [01:38<00:15,  5.17s/it, loss=0.428, acc=67.5]Training:  91%|█████████ | 20/22 [01:38<00:10,  5.29s/it, loss=0.428, acc=67.5]Training:  91%|█████████ | 20/22 [01:42<00:10,  5.29s/it, loss=0.751, acc=67.7]Training:  95%|█████████▌| 21/22 [01:42<00:04,  4.83s/it, loss=0.751, acc=67.7]Training:  95%|█████████▌| 21/22 [01:42<00:04,  4.83s/it, loss=0.231, acc=67.9]Training: 100%|██████████| 22/22 [01:42<00:00,  3.48s/it, loss=0.231, acc=67.9]                                                                               Validating:   0%|          | 0/5 [00:00<?, ?it/s]Validating:  20%|██        | 1/5 [00:03<00:14,  3.56s/it]Validating:  40%|████      | 2/5 [00:06<00:09,  3.06s/it]Validating:  60%|██████    | 3/5 [00:09<00:06,  3.22s/it]Validating:  80%|████████  | 4/5 [00:12<00:03,  3.04s/it]Validating: 100%|██████████| 5/5 [00:13<00:00,  2.36s/it]                                                         Training:   0%|          | 0/22 [00:00<?, ?it/s]Epoch 00010: reducing learning rate of group 0 to 5.0000e-05.
Train Loss: 0.7291, Train Acc: 67.85%
Val Loss: 0.9938, Val Acc: 66.21%
No improvement for 6 epochs

Epoch 11/50
Training:   0%|          | 0/22 [00:05<?, ?it/s, loss=0.741, acc=71.9]Training:   5%|▍         | 1/22 [00:05<01:46,  5.05s/it, loss=0.741, acc=71.9]Training:   5%|▍         | 1/22 [00:09<01:46,  5.05s/it, loss=0.541, acc=76.6]Training:   9%|▉         | 2/22 [00:09<01:37,  4.87s/it, loss=0.541, acc=76.6]Training:   9%|▉         | 2/22 [00:14<01:37,  4.87s/it, loss=0.851, acc=71.9]Training:  14%|█▎        | 3/22 [00:14<01:33,  4.92s/it, loss=0.851, acc=71.9]Training:  14%|█▎        | 3/22 [00:19<01:33,  4.92s/it, loss=0.589, acc=71.9]Training:  18%|█▊        | 4/22 [00:19<01:27,  4.84s/it, loss=0.589, acc=71.9]Training:  18%|█▊        | 4/22 [00:24<01:27,  4.84s/it, loss=0.608, acc=73.1]Training:  23%|██▎       | 5/22 [00:24<01:22,  4.85s/it, loss=0.608, acc=73.1]Training:  23%|██▎       | 5/22 [00:29<01:22,  4.85s/it, loss=0.72, acc=71.4] Training:  27%|██▋       | 6/22 [00:29<01:20,  5.04s/it, loss=0.72, acc=71.4]Training:  27%|██▋       | 6/22 [00:33<01:20,  5.04s/it, loss=0.562, acc=72.3]Training:  32%|███▏      | 7/22 [00:33<01:11,  4.73s/it, loss=0.562, acc=72.3]Training:  32%|███▏      | 7/22 [00:38<01:11,  4.73s/it, loss=0.749, acc=71.9]Training:  36%|███▋      | 8/22 [00:38<01:04,  4.61s/it, loss=0.749, acc=71.9]Training:  36%|███▋      | 8/22 [00:42<01:04,  4.61s/it, loss=0.892, acc=71.2]Training:  41%|████      | 9/22 [00:42<00:58,  4.49s/it, loss=0.892, acc=71.2]Training:  41%|████      | 9/22 [00:47<00:58,  4.49s/it, loss=0.705, acc=72.2]Training:  45%|████▌     | 10/22 [00:47<00:57,  4.78s/it, loss=0.705, acc=72.2]Training:  45%|████▌     | 10/22 [00:52<00:57,  4.78s/it, loss=0.427, acc=73.6]Training:  50%|█████     | 11/22 [00:52<00:53,  4.86s/it, loss=0.427, acc=73.6]Training:  50%|█████     | 11/22 [00:58<00:53,  4.86s/it, loss=0.686, acc=73.7]Training:  55%|█████▍    | 12/22 [00:58<00:51,  5.15s/it, loss=0.686, acc=73.7]Training:  55%|█████▍    | 12/22 [01:04<00:51,  5.15s/it, loss=0.495, acc=74.5]Training:  59%|█████▉    | 13/22 [01:04<00:47,  5.27s/it, loss=0.495, acc=74.5]Training:  59%|█████▉    | 13/22 [01:07<00:47,  5.27s/it, loss=0.727, acc=74.6]Training:  64%|██████▎   | 14/22 [01:07<00:38,  4.77s/it, loss=0.727, acc=74.6]Training:  64%|██████▎   | 14/22 [01:12<00:38,  4.77s/it, loss=0.61, acc=74.6] Training:  68%|██████▊   | 15/22 [01:12<00:33,  4.78s/it, loss=0.61, acc=74.6]Training:  68%|██████▊   | 15/22 [01:16<00:33,  4.78s/it, loss=0.654, acc=74.2]Training:  73%|███████▎  | 16/22 [01:16<00:26,  4.42s/it, loss=0.654, acc=74.2]Training:  73%|███████▎  | 16/22 [01:21<00:26,  4.42s/it, loss=0.683, acc=73.9]Training:  77%|███████▋  | 17/22 [01:21<00:22,  4.55s/it, loss=0.683, acc=73.9]Training:  77%|███████▋  | 17/22 [01:25<00:22,  4.55s/it, loss=0.663, acc=74]  Training:  82%|████████▏ | 18/22 [01:25<00:18,  4.52s/it, loss=0.663, acc=74]Training:  82%|████████▏ | 18/22 [01:31<00:18,  4.52s/it, loss=0.845, acc=73.5]Training:  86%|████████▋ | 19/22 [01:31<00:14,  4.98s/it, loss=0.845, acc=73.5]Training:  86%|████████▋ | 19/22 [01:36<00:14,  4.98s/it, loss=0.798, acc=73.1]Training:  91%|█████████ | 20/22 [01:36<00:09,  4.98s/it, loss=0.798, acc=73.1]Training:  91%|█████████ | 20/22 [01:41<00:09,  4.98s/it, loss=0.646, acc=73.2]Training:  95%|█████████▌| 21/22 [01:41<00:05,  5.04s/it, loss=0.646, acc=73.2]Training:  95%|█████████▌| 21/22 [01:42<00:05,  5.04s/it, loss=1.96, acc=73]   Training: 100%|██████████| 22/22 [01:42<00:00,  3.77s/it, loss=1.96, acc=73]                                                                            Validating:   0%|          | 0/5 [00:00<?, ?it/s]Validating:  20%|██        | 1/5 [00:03<00:14,  3.59s/it]Validating:  40%|████      | 2/5 [00:06<00:09,  3.06s/it]Validating:  60%|██████    | 3/5 [00:09<00:06,  3.22s/it]Validating:  80%|████████  | 4/5 [00:12<00:03,  3.02s/it]Validating: 100%|██████████| 5/5 [00:13<00:00,  2.35s/it]                                                         Train Loss: 0.6814, Train Acc: 73.04%
Val Loss: 0.9499, Val Acc: 65.52%
No improvement for 7 epochs

Epoch 12/50
Training:   0%|          | 0/22 [00:00<?, ?it/s]Training:   0%|          | 0/22 [00:04<?, ?it/s, loss=0.527, acc=81.2]Training:   5%|▍         | 1/22 [00:04<01:37,  4.65s/it, loss=0.527, acc=81.2]Training:   5%|▍         | 1/22 [00:08<01:37,  4.65s/it, loss=0.788, acc=71.9]Training:   9%|▉         | 2/22 [00:08<01:29,  4.46s/it, loss=0.788, acc=71.9]Training:   9%|▉         | 2/22 [00:13<01:29,  4.46s/it, loss=0.777, acc=66.7]Training:  14%|█▎        | 3/22 [00:13<01:24,  4.42s/it, loss=0.777, acc=66.7]Training:  14%|█▎        | 3/22 [00:18<01:24,  4.42s/it, loss=0.725, acc=66.4]Training:  18%|█▊        | 4/22 [00:18<01:22,  4.57s/it, loss=0.725, acc=66.4]Training:  18%|█▊        | 4/22 [00:23<01:22,  4.57s/it, loss=0.568, acc=68.1]Training:  23%|██▎       | 5/22 [00:23<01:24,  4.98s/it, loss=0.568, acc=68.1]Training:  23%|██▎       | 5/22 [00:28<01:24,  4.98s/it, loss=0.52, acc=70.3] Training:  27%|██▋       | 6/22 [00:28<01:17,  4.83s/it, loss=0.52, acc=70.3]Training:  27%|██▋       | 6/22 [00:34<01:17,  4.83s/it, loss=0.734, acc=69.6]Training:  32%|███▏      | 7/22 [00:34<01:17,  5.16s/it, loss=0.734, acc=69.6]Training:  32%|███▏      | 7/22 [00:38<01:17,  5.16s/it, loss=0.564, acc=71.5]Training:  36%|███▋      | 8/22 [00:38<01:07,  4.85s/it, loss=0.564, acc=71.5]Training:  36%|███▋      | 8/22 [00:42<01:07,  4.85s/it, loss=0.724, acc=70.1]Training:  41%|████      | 9/22 [00:42<01:01,  4.74s/it, loss=0.724, acc=70.1]Training:  41%|████      | 9/22 [00:47<01:01,  4.74s/it, loss=0.727, acc=70]  Training:  45%|████▌     | 10/22 [00:47<00:56,  4.71s/it, loss=0.727, acc=70]Training:  45%|████▌     | 10/22 [00:52<00:56,  4.71s/it, loss=0.67, acc=70.2]Training:  50%|█████     | 11/22 [00:52<00:51,  4.69s/it, loss=0.67, acc=70.2]Training:  50%|█████     | 11/22 [00:56<00:51,  4.69s/it, loss=0.71, acc=70.6]Training:  55%|█████▍    | 12/22 [00:56<00:46,  4.68s/it, loss=0.71, acc=70.6]Training:  55%|█████▍    | 12/22 [01:02<00:46,  4.68s/it, loss=0.621, acc=70.9]Training:  59%|█████▉    | 13/22 [01:02<00:44,  4.97s/it, loss=0.621, acc=70.9]Training:  59%|█████▉    | 13/22 [01:07<00:44,  4.97s/it, loss=0.482, acc=72.1]Training:  64%|██████▎   | 14/22 [01:07<00:39,  4.90s/it, loss=0.482, acc=72.1]Training:  64%|██████▎   | 14/22 [01:12<00:39,  4.90s/it, loss=0.706, acc=71.9]Training:  68%|██████▊   | 15/22 [01:12<00:35,  5.09s/it, loss=0.706, acc=71.9]Training:  68%|██████▊   | 15/22 [01:17<00:35,  5.09s/it, loss=0.757, acc=71.1]Training:  73%|███████▎  | 16/22 [01:17<00:29,  4.99s/it, loss=0.757, acc=71.1]Training:  73%|███████▎  | 16/22 [01:22<00:29,  4.99s/it, loss=0.732, acc=71.3]Training:  77%|███████▋  | 17/22 [01:22<00:24,  4.95s/it, loss=0.732, acc=71.3]Training:  77%|███████▋  | 17/22 [01:26<00:24,  4.95s/it, loss=0.864, acc=70.7]Training:  82%|████████▏ | 18/22 [01:26<00:18,  4.72s/it, loss=0.864, acc=70.7]Training:  82%|████████▏ | 18/22 [01:31<00:18,  4.72s/it, loss=0.937, acc=70.2]Training:  86%|████████▋ | 19/22 [01:31<00:14,  4.76s/it, loss=0.937, acc=70.2]Training:  86%|████████▋ | 19/22 [01:36<00:14,  4.76s/it, loss=0.543, acc=70.8]Training:  91%|█████████ | 20/22 [01:36<00:09,  4.72s/it, loss=0.543, acc=70.8]Training:  91%|█████████ | 20/22 [01:40<00:09,  4.72s/it, loss=0.732, acc=70.8]Training:  95%|█████████▌| 21/22 [01:40<00:04,  4.72s/it, loss=0.732, acc=70.8]Training:  95%|█████████▌| 21/22 [01:41<00:04,  4.72s/it, loss=0.204, acc=71]  Training: 100%|██████████| 22/22 [01:41<00:00,  3.45s/it, loss=0.204, acc=71]                                                                             Validating:   0%|          | 0/5 [00:00<?, ?it/s]Validating:  20%|██        | 1/5 [00:03<00:14,  3.52s/it]Validating:  40%|████      | 2/5 [00:06<00:09,  3.08s/it]Validating:  60%|██████    | 3/5 [00:09<00:06,  3.25s/it]Validating:  80%|████████  | 4/5 [00:12<00:03,  3.05s/it]Validating: 100%|██████████| 5/5 [00:13<00:00,  2.39s/it]                                                         Train Loss: 0.6840, Train Acc: 70.96%
Val Loss: 0.9672, Val Acc: 70.34%
New best model saved! Val Acc: 70.34%

Epoch 13/50
Training:   0%|          | 0/22 [00:00<?, ?it/s]Training:   0%|          | 0/22 [00:03<?, ?it/s, loss=0.427, acc=90.6]Training:   5%|▍         | 1/22 [00:03<01:18,  3.74s/it, loss=0.427, acc=90.6]Training:   5%|▍         | 1/22 [00:09<01:18,  3.74s/it, loss=0.903, acc=78.1]Training:   9%|▉         | 2/22 [00:09<01:38,  4.92s/it, loss=0.903, acc=78.1]Training:   9%|▉         | 2/22 [00:14<01:38,  4.92s/it, loss=0.752, acc=74]  Training:  14%|█▎        | 3/22 [00:14<01:33,  4.93s/it, loss=0.752, acc=74]Training:  14%|█▎        | 3/22 [00:18<01:33,  4.93s/it, loss=0.481, acc=76.6]Training:  18%|█▊        | 4/22 [00:18<01:20,  4.50s/it, loss=0.481, acc=76.6]Training:  18%|█▊        | 4/22 [00:23<01:20,  4.50s/it, loss=0.621, acc=75.6]Training:  23%|██▎       | 5/22 [00:23<01:20,  4.72s/it, loss=0.621, acc=75.6]Training:  23%|██▎       | 5/22 [00:28<01:20,  4.72s/it, loss=0.613, acc=76.6]Training:  27%|██▋       | 6/22 [00:28<01:17,  4.86s/it, loss=0.613, acc=76.6]Training:  27%|██▋       | 6/22 [00:33<01:17,  4.86s/it, loss=0.731, acc=74.6]Training:  32%|███▏      | 7/22 [00:33<01:12,  4.84s/it, loss=0.731, acc=74.6]Training:  32%|███▏      | 7/22 [00:37<01:12,  4.84s/it, loss=0.507, acc=75.4]Training:  36%|███▋      | 8/22 [00:37<01:05,  4.64s/it, loss=0.507, acc=75.4]Training:  36%|███▋      | 8/22 [00:42<01:05,  4.64s/it, loss=0.548, acc=75.3]Training:  41%|████      | 9/22 [00:42<01:00,  4.67s/it, loss=0.548, acc=75.3]Training:  41%|████      | 9/22 [00:46<01:00,  4.67s/it, loss=0.514, acc=75.9]Training:  45%|████▌     | 10/22 [00:46<00:56,  4.67s/it, loss=0.514, acc=75.9]Training:  45%|████▌     | 10/22 [00:51<00:56,  4.67s/it, loss=0.528, acc=75.6]Training:  50%|█████     | 11/22 [00:51<00:49,  4.52s/it, loss=0.528, acc=75.6]Training:  50%|█████     | 11/22 [00:56<00:49,  4.52s/it, loss=0.6, acc=75]    Training:  55%|█████▍    | 12/22 [00:56<00:47,  4.74s/it, loss=0.6, acc=75]Training:  55%|█████▍    | 12/22 [01:00<00:47,  4.74s/it, loss=0.809, acc=74.5]Training:  59%|█████▉    | 13/22 [01:00<00:42,  4.70s/it, loss=0.809, acc=74.5]Training:  59%|█████▉    | 13/22 [01:07<00:42,  4.70s/it, loss=0.69, acc=73.9] Training:  64%|██████▎   | 14/22 [01:07<00:40,  5.12s/it, loss=0.69, acc=73.9]Training:  64%|██████▎   | 14/22 [01:10<00:40,  5.12s/it, loss=0.994, acc=72.9]Training:  68%|██████▊   | 15/22 [01:10<00:33,  4.77s/it, loss=0.994, acc=72.9]Training:  68%|██████▊   | 15/22 [01:15<00:33,  4.77s/it, loss=0.728, acc=72.5]Training:  73%|███████▎  | 16/22 [01:15<00:27,  4.54s/it, loss=0.728, acc=72.5]Training:  73%|███████▎  | 16/22 [01:19<00:27,  4.54s/it, loss=0.803, acc=72.1]Training:  77%|███████▋  | 17/22 [01:19<00:22,  4.54s/it, loss=0.803, acc=72.1]Training:  77%|███████▋  | 17/22 [01:24<00:22,  4.54s/it, loss=0.843, acc=71.4]Training:  82%|████████▏ | 18/22 [01:24<00:18,  4.67s/it, loss=0.843, acc=71.4]Training:  82%|████████▏ | 18/22 [01:30<00:18,  4.67s/it, loss=0.662, acc=71.5]Training:  86%|████████▋ | 19/22 [01:30<00:15,  5.03s/it, loss=0.662, acc=71.5]Training:  86%|████████▋ | 19/22 [01:35<00:15,  5.03s/it, loss=0.683, acc=71.2]Training:  91%|█████████ | 20/22 [01:35<00:10,  5.03s/it, loss=0.683, acc=71.2]Training:  91%|█████████ | 20/22 [01:39<00:10,  5.03s/it, loss=0.603, acc=71.1]Training:  95%|█████████▌| 21/22 [01:39<00:04,  4.80s/it, loss=0.603, acc=71.1]Training:  95%|█████████▌| 21/22 [01:40<00:04,  4.80s/it, loss=0.308, acc=71.3]Training: 100%|██████████| 22/22 [01:40<00:00,  3.55s/it, loss=0.308, acc=71.3]                                                                               Validating:   0%|          | 0/5 [00:00<?, ?it/s]Validating:  20%|██        | 1/5 [00:03<00:13,  3.49s/it]Validating:  40%|████      | 2/5 [00:06<00:08,  2.98s/it]Validating:  60%|██████    | 3/5 [00:09<00:06,  3.14s/it]Validating:  80%|████████  | 4/5 [00:12<00:02,  2.98s/it]Validating: 100%|██████████| 5/5 [00:13<00:00,  2.32s/it]                                                         Train Loss: 0.6669, Train Acc: 71.26%
Val Loss: 0.9947, Val Acc: 66.21%
No improvement for 1 epochs

Epoch 14/50
Training:   0%|          | 0/22 [00:00<?, ?it/s]Training:   0%|          | 0/22 [00:04<?, ?it/s, loss=0.679, acc=71.9]Training:   5%|▍         | 1/22 [00:04<01:34,  4.51s/it, loss=0.679, acc=71.9]Training:   5%|▍         | 1/22 [00:09<01:34,  4.51s/it, loss=0.727, acc=71.9]Training:   9%|▉         | 2/22 [00:09<01:33,  4.65s/it, loss=0.727, acc=71.9]Training:   9%|▉         | 2/22 [00:13<01:33,  4.65s/it, loss=0.782, acc=69.8]Training:  14%|█▎        | 3/22 [00:13<01:23,  4.40s/it, loss=0.782, acc=69.8]Training:  14%|█▎        | 3/22 [00:17<01:23,  4.40s/it, loss=0.771, acc=70.3]Training:  18%|█▊        | 4/22 [00:17<01:17,  4.33s/it, loss=0.771, acc=70.3]Training:  18%|█▊        | 4/22 [00:22<01:17,  4.33s/it, loss=0.938, acc=68.8]Training:  23%|██▎       | 5/22 [00:22<01:18,  4.60s/it, loss=0.938, acc=68.8]Training:  23%|██▎       | 5/22 [00:27<01:18,  4.60s/it, loss=0.579, acc=69.8]Training:  27%|██▋       | 6/22 [00:27<01:17,  4.83s/it, loss=0.579, acc=69.8]Training:  27%|██▋       | 6/22 [00:32<01:17,  4.83s/it, loss=0.634, acc=71]  Training:  32%|███▏      | 7/22 [00:32<01:09,  4.66s/it, loss=0.634, acc=71]Training:  32%|███▏      | 7/22 [00:36<01:09,  4.66s/it, loss=0.494, acc=72.7]Training:  36%|███▋      | 8/22 [00:36<01:04,  4.64s/it, loss=0.494, acc=72.7]Training:  36%|███▋      | 8/22 [00:41<01:04,  4.64s/it, loss=0.527, acc=73.3]Training:  41%|████      | 9/22 [00:41<01:01,  4.76s/it, loss=0.527, acc=73.3]Training:  41%|████      | 9/22 [00:46<01:01,  4.76s/it, loss=0.512, acc=74.4]Training:  45%|████▌     | 10/22 [00:46<00:56,  4.68s/it, loss=0.512, acc=74.4]Training:  45%|████▌     | 10/22 [00:51<00:56,  4.68s/it, loss=0.588, acc=74.4]Training:  50%|█████     | 11/22 [00:51<00:51,  4.70s/it, loss=0.588, acc=74.4]Training:  50%|█████     | 11/22 [00:56<00:51,  4.70s/it, loss=0.502, acc=75.5]Training:  55%|█████▍    | 12/22 [00:56<00:50,  5.02s/it, loss=0.502, acc=75.5]Training:  55%|█████▍    | 12/22 [01:02<00:50,  5.02s/it, loss=0.668, acc=75.5]Training:  59%|█████▉    | 13/22 [01:02<00:47,  5.24s/it, loss=0.668, acc=75.5]Training:  59%|█████▉    | 13/22 [01:07<00:47,  5.24s/it, loss=0.564, acc=75.4]Training:  64%|██████▎   | 14/22 [01:07<00:41,  5.20s/it, loss=0.564, acc=75.4]Training:  64%|██████▎   | 14/22 [01:12<00:41,  5.20s/it, loss=0.599, acc=75.6]Training:  68%|██████▊   | 15/22 [01:12<00:35,  5.05s/it, loss=0.599, acc=75.6]Training:  68%|██████▊   | 15/22 [01:16<00:35,  5.05s/it, loss=0.695, acc=75.2]Training:  73%|███████▎  | 16/22 [01:16<00:29,  4.88s/it, loss=0.695, acc=75.2]Training:  73%|███████▎  | 16/22 [01:20<00:29,  4.88s/it, loss=0.695, acc=75.2]Training:  77%|███████▋  | 17/22 [01:20<00:21,  4.36s/it, loss=0.695, acc=75.2]Training:  77%|███████▋  | 17/22 [01:24<00:21,  4.36s/it, loss=0.629, acc=75]  Training:  82%|████████▏ | 18/22 [01:24<00:17,  4.41s/it, loss=0.629, acc=75]Training:  82%|████████▏ | 18/22 [01:30<00:17,  4.41s/it, loss=0.668, acc=74.8]Training:  86%|████████▋ | 19/22 [01:30<00:14,  4.77s/it, loss=0.668, acc=74.8]Training:  86%|████████▋ | 19/22 [01:34<00:14,  4.77s/it, loss=0.894, acc=73.9]Training:  91%|█████████ | 20/22 [01:34<00:09,  4.67s/it, loss=0.894, acc=73.9]Training:  91%|█████████ | 20/22 [01:39<00:09,  4.67s/it, loss=0.603, acc=73.8]Training:  95%|█████████▌| 21/22 [01:39<00:04,  4.72s/it, loss=0.603, acc=73.8]Training:  95%|█████████▌| 21/22 [01:39<00:04,  4.72s/it, loss=0.598, acc=73.8]Training: 100%|██████████| 22/22 [01:39<00:00,  3.40s/it, loss=0.598, acc=73.8]                                                                               Validating:   0%|          | 0/5 [00:00<?, ?it/s]Validating:  20%|██        | 1/5 [00:03<00:13,  3.49s/it]Validating:  40%|████      | 2/5 [00:06<00:08,  2.98s/it]Validating:  60%|██████    | 3/5 [00:09<00:06,  3.15s/it]Validating:  80%|████████  | 4/5 [00:12<00:02,  2.99s/it]Validating: 100%|██████████| 5/5 [00:13<00:00,  2.34s/it]                                                         Train Loss: 0.6545, Train Acc: 73.78%
Val Loss: 1.0135, Val Acc: 65.52%
No improvement for 2 epochs

Epoch 15/50
Training:   0%|          | 0/22 [00:00<?, ?it/s]Training:   0%|          | 0/22 [00:04<?, ?it/s, loss=0.502, acc=78.1]Training:   5%|▍         | 1/22 [00:04<01:39,  4.73s/it, loss=0.502, acc=78.1]Training:   5%|▍         | 1/22 [00:09<01:39,  4.73s/it, loss=0.655, acc=75]  Training:   9%|▉         | 2/22 [00:09<01:36,  4.84s/it, loss=0.655, acc=75]Training:   9%|▉         | 2/22 [00:13<01:36,  4.84s/it, loss=0.582, acc=75]Training:  14%|█▎        | 3/22 [00:13<01:21,  4.29s/it, loss=0.582, acc=75]Training:  14%|█▎        | 3/22 [00:16<01:21,  4.29s/it, loss=0.633, acc=74.2]Training:  18%|█▊        | 4/22 [00:16<01:10,  3.91s/it, loss=0.633, acc=74.2]Training:  18%|█▊        | 4/22 [00:20<01:10,  3.91s/it, loss=1.15, acc=70.6] Training:  23%|██▎       | 5/22 [00:20<01:06,  3.94s/it, loss=1.15, acc=70.6]Training:  23%|██▎       | 5/22 [00:25<01:06,  3.94s/it, loss=0.606, acc=71.4]Training:  27%|██▋       | 6/22 [00:25<01:10,  4.41s/it, loss=0.606, acc=71.4]Training:  27%|██▋       | 6/22 [00:31<01:10,  4.41s/it, loss=0.458, acc=73.2]Training:  32%|███▏      | 7/22 [00:31<01:11,  4.80s/it, loss=0.458, acc=73.2]Training:  32%|███▏      | 7/22 [00:36<01:11,  4.80s/it, loss=0.684, acc=72.3]Training:  36%|███▋      | 8/22 [00:36<01:07,  4.82s/it, loss=0.684, acc=72.3]Training:  36%|███▋      | 8/22 [00:41<01:07,  4.82s/it, loss=0.718, acc=72.2]Training:  41%|████      | 9/22 [00:41<01:02,  4.82s/it, loss=0.718, acc=72.2]Training:  41%|████      | 9/22 [00:47<01:02,  4.82s/it, loss=0.6, acc=72.8]  Training:  45%|████▌     | 10/22 [00:47<01:02,  5.23s/it, loss=0.6, acc=72.8]Training:  45%|████▌     | 10/22 [00:51<01:02,  5.23s/it, loss=0.437, acc=73.9]Training:  50%|█████     | 11/22 [00:51<00:54,  4.97s/it, loss=0.437, acc=73.9]Training:  50%|█████     | 11/22 [00:57<00:54,  4.97s/it, loss=0.758, acc=73.2]Training:  55%|█████▍    | 12/22 [00:57<00:50,  5.07s/it, loss=0.758, acc=73.2]Training:  55%|█████▍    | 12/22 [01:01<00:50,  5.07s/it, loss=0.514, acc=74]  Training:  59%|█████▉    | 13/22 [01:01<00:44,  4.97s/it, loss=0.514, acc=74]Training:  59%|█████▉    | 13/22 [01:06<00:44,  4.97s/it, loss=0.661, acc=73.7]Training:  64%|██████▎   | 14/22 [01:06<00:39,  4.95s/it, loss=0.661, acc=73.7]Training:  64%|██████▎   | 14/22 [01:12<00:39,  4.95s/it, loss=0.73, acc=73.5] Training:  68%|██████▊   | 15/22 [01:12<00:36,  5.16s/it, loss=0.73, acc=73.5]Training:  68%|██████▊   | 15/22 [01:17<00:36,  5.16s/it, loss=0.392, acc=74] Training:  73%|███████▎  | 16/22 [01:17<00:31,  5.25s/it, loss=0.392, acc=74]Training:  73%|███████▎  | 16/22 [01:21<00:31,  5.25s/it, loss=0.782, acc=73.5]Training:  77%|███████▋  | 17/22 [01:21<00:24,  4.88s/it, loss=0.782, acc=73.5]Training:  77%|███████▋  | 17/22 [01:25<00:24,  4.88s/it, loss=0.552, acc=73.4]Training:  82%|████████▏ | 18/22 [01:25<00:18,  4.61s/it, loss=0.552, acc=73.4]Training:  82%|████████▏ | 18/22 [01:30<00:18,  4.61s/it, loss=0.903, acc=73.2]Training:  86%|████████▋ | 19/22 [01:30<00:13,  4.56s/it, loss=0.903, acc=73.2]Training:  86%|████████▋ | 19/22 [01:35<00:13,  4.56s/it, loss=0.831, acc=72.8]Training:  91%|█████████ | 20/22 [01:35<00:09,  4.80s/it, loss=0.831, acc=72.8]Training:  91%|█████████ | 20/22 [01:40<00:09,  4.80s/it, loss=0.755, acc=72.2]Training:  95%|█████████▌| 21/22 [01:40<00:04,  4.92s/it, loss=0.755, acc=72.2]Training:  95%|█████████▌| 21/22 [01:41<00:04,  4.92s/it, loss=0.355, acc=72.3]Training: 100%|██████████| 22/22 [01:41<00:00,  3.67s/it, loss=0.355, acc=72.3]                                                                               Validating:   0%|          | 0/5 [00:00<?, ?it/s]Validating:  20%|██        | 1/5 [00:03<00:14,  3.57s/it]Validating:  40%|████      | 2/5 [00:06<00:09,  3.03s/it]Validating:  60%|██████    | 3/5 [00:09<00:06,  3.19s/it]Validating:  80%|████████  | 4/5 [00:12<00:03,  3.01s/it]Validating: 100%|██████████| 5/5 [00:13<00:00,  2.36s/it]                                                         Train Loss: 0.6608, Train Acc: 72.30%
Val Loss: 1.0033, Val Acc: 66.21%
No improvement for 3 epochs

Epoch 16/50
Training:   0%|          | 0/22 [00:00<?, ?it/s]Training:   0%|          | 0/22 [00:04<?, ?it/s, loss=0.54, acc=75]Training:   5%|▍         | 1/22 [00:04<01:38,  4.71s/it, loss=0.54, acc=75]Training:   5%|▍         | 1/22 [00:08<01:38,  4.71s/it, loss=0.503, acc=79.7]Training:   9%|▉         | 2/22 [00:08<01:27,  4.39s/it, loss=0.503, acc=79.7]Training:   9%|▉         | 2/22 [00:12<01:27,  4.39s/it, loss=0.661, acc=76]  Training:  14%|█▎        | 3/22 [00:12<01:15,  4.00s/it, loss=0.661, acc=76]Training:  14%|█▎        | 3/22 [00:16<01:15,  4.00s/it, loss=0.709, acc=73.4]Training:  18%|█▊        | 4/22 [00:16<01:13,  4.08s/it, loss=0.709, acc=73.4]Training:  18%|█▊        | 4/22 [00:20<01:13,  4.08s/it, loss=0.63, acc=73.8] Training:  23%|██▎       | 5/22 [00:20<01:09,  4.10s/it, loss=0.63, acc=73.8]Training:  23%|██▎       | 5/22 [00:25<01:09,  4.10s/it, loss=0.739, acc=72.9]Training:  27%|██▋       | 6/22 [00:25<01:10,  4.38s/it, loss=0.739, acc=72.9]Training:  27%|██▋       | 6/22 [00:29<01:10,  4.38s/it, loss=0.764, acc=71.9]Training:  32%|███▏      | 7/22 [00:29<01:04,  4.28s/it, loss=0.764, acc=71.9]Training:  32%|███▏      | 7/22 [00:33<01:04,  4.28s/it, loss=0.642, acc=72.7]Training:  36%|███▋      | 8/22 [00:33<00:59,  4.25s/it, loss=0.642, acc=72.7]Training:  36%|███▋      | 8/22 [00:38<00:59,  4.25s/it, loss=0.442, acc=74.7]Training:  41%|████      | 9/22 [00:38<00:57,  4.44s/it, loss=0.442, acc=74.7]Training:  41%|████      | 9/22 [00:44<00:57,  4.44s/it, loss=0.448, acc=75.6]Training:  45%|████▌     | 10/22 [00:44<00:58,  4.92s/it, loss=0.448, acc=75.6]Training:  45%|████▌     | 10/22 [00:49<00:58,  4.92s/it, loss=0.876, acc=75]  Training:  50%|█████     | 11/22 [00:49<00:54,  4.91s/it, loss=0.876, acc=75]Training:  50%|█████     | 11/22 [00:55<00:54,  4.91s/it, loss=0.594, acc=74.7]Training:  55%|█████▍    | 12/22 [00:55<00:50,  5.10s/it, loss=0.594, acc=74.7]Training:  55%|█████▍    | 12/22 [01:01<00:50,  5.10s/it, loss=0.621, acc=74.8]Training:  59%|█████▉    | 13/22 [01:01<00:48,  5.34s/it, loss=0.621, acc=74.8]Training:  59%|█████▉    | 13/22 [01:06<00:48,  5.34s/it, loss=0.797, acc=74.1]Training:  64%|██████▎   | 14/22 [01:06<00:43,  5.38s/it, loss=0.797, acc=74.1]Training:  64%|██████▎   | 14/22 [01:10<00:43,  5.38s/it, loss=0.805, acc=73.1]Training:  68%|██████▊   | 15/22 [01:10<00:35,  5.06s/it, loss=0.805, acc=73.1]Training:  68%|██████▊   | 15/22 [01:16<00:35,  5.06s/it, loss=0.673, acc=72.7]Training:  73%|███████▎  | 16/22 [01:16<00:31,  5.22s/it, loss=0.673, acc=72.7]Training:  73%|███████▎  | 16/22 [01:21<00:31,  5.22s/it, loss=0.6, acc=72.6]  Training:  77%|███████▋  | 17/22 [01:21<00:26,  5.30s/it, loss=0.6, acc=72.6]Training:  77%|███████▋  | 17/22 [01:27<00:26,  5.30s/it, loss=0.463, acc=73.1]Training:  82%|████████▏ | 18/22 [01:27<00:21,  5.28s/it, loss=0.463, acc=73.1]Training:  82%|████████▏ | 18/22 [01:31<00:21,  5.28s/it, loss=0.72, acc=73]   Training:  86%|████████▋ | 19/22 [01:31<00:14,  4.88s/it, loss=0.72, acc=73]Training:  86%|████████▋ | 19/22 [01:35<00:14,  4.88s/it, loss=0.887, acc=72.5]Training:  91%|█████████ | 20/22 [01:35<00:09,  4.87s/it, loss=0.887, acc=72.5]Training:  91%|█████████ | 20/22 [01:40<00:09,  4.87s/it, loss=1, acc=71.9]    Training:  95%|█████████▌| 21/22 [01:40<00:04,  4.78s/it, loss=1, acc=71.9]Training:  95%|█████████▌| 21/22 [01:41<00:04,  4.78s/it, loss=0.259, acc=72]Training: 100%|██████████| 22/22 [01:41<00:00,  3.54s/it, loss=0.259, acc=72]                                                                             Validating:   0%|          | 0/5 [00:00<?, ?it/s]Validating:  20%|██        | 1/5 [00:03<00:14,  3.51s/it]Validating:  40%|████      | 2/5 [00:06<00:09,  3.00s/it]Validating:  60%|██████    | 3/5 [00:09<00:06,  3.17s/it]Validating:  80%|████████  | 4/5 [00:12<00:02,  2.98s/it]Validating: 100%|██████████| 5/5 [00:13<00:00,  2.32s/it]                                                         Train Loss: 0.6705, Train Acc: 72.00%
Val Loss: 0.9507, Val Acc: 66.21%
No improvement for 4 epochs

Epoch 17/50
Training:   0%|          | 0/22 [00:00<?, ?it/s]Training:   0%|          | 0/22 [00:04<?, ?it/s, loss=0.561, acc=81.2]Training:   5%|▍         | 1/22 [00:04<01:27,  4.14s/it, loss=0.561, acc=81.2]Training:   5%|▍         | 1/22 [00:09<01:27,  4.14s/it, loss=0.64, acc=76.6] Training:   9%|▉         | 2/22 [00:09<01:31,  4.57s/it, loss=0.64, acc=76.6]Training:   9%|▉         | 2/22 [00:15<01:31,  4.57s/it, loss=0.526, acc=78.1]Training:  14%|█▎        | 3/22 [00:15<01:39,  5.22s/it, loss=0.526, acc=78.1]Training:  14%|█▎        | 3/22 [00:19<01:39,  5.22s/it, loss=0.682, acc=77.3]Training:  18%|█▊        | 4/22 [00:19<01:27,  4.87s/it, loss=0.682, acc=77.3]Training:  18%|█▊        | 4/22 [00:23<01:27,  4.87s/it, loss=0.613, acc=76.2]Training:  23%|██▎       | 5/22 [00:23<01:19,  4.68s/it, loss=0.613, acc=76.2]Training:  23%|██▎       | 5/22 [00:29<01:19,  4.68s/it, loss=0.702, acc=74.5]Training:  27%|██▋       | 6/22 [00:29<01:19,  4.99s/it, loss=0.702, acc=74.5]Training:  27%|██▋       | 6/22 [00:34<01:19,  4.99s/it, loss=0.848, acc=72.8]Training:  32%|███▏      | 7/22 [00:34<01:16,  5.12s/it, loss=0.848, acc=72.8]Training:  32%|███▏      | 7/22 [00:38<01:16,  5.12s/it, loss=0.507, acc=73.8]Training:  36%|███▋      | 8/22 [00:38<01:05,  4.67s/it, loss=0.507, acc=73.8]Training:  36%|███▋      | 8/22 [00:43<01:05,  4.67s/it, loss=0.947, acc=71.9]Training:  41%|████      | 9/22 [00:43<01:04,  4.96s/it, loss=0.947, acc=71.9]Training:  41%|████      | 9/22 [00:48<01:04,  4.96s/it, loss=0.605, acc=71.9]Training:  45%|████▌     | 10/22 [00:48<00:57,  4.83s/it, loss=0.605, acc=71.9]Training:  45%|████▌     | 10/22 [00:53<00:57,  4.83s/it, loss=0.301, acc=74.1]Training:  50%|█████     | 11/22 [00:53<00:54,  4.93s/it, loss=0.301, acc=74.1]Training:  50%|█████     | 11/22 [00:58<00:54,  4.93s/it, loss=0.688, acc=73.7]Training:  55%|█████▍    | 12/22 [00:58<00:47,  4.77s/it, loss=0.688, acc=73.7]Training:  55%|█████▍    | 12/22 [01:03<00:47,  4.77s/it, loss=0.598, acc=73.6]Training:  59%|█████▉    | 13/22 [01:03<00:43,  4.86s/it, loss=0.598, acc=73.6]Training:  59%|█████▉    | 13/22 [01:07<00:43,  4.86s/it, loss=0.532, acc=73.7]Training:  64%|██████▎   | 14/22 [01:07<00:38,  4.81s/it, loss=0.532, acc=73.7]Training:  64%|██████▎   | 14/22 [01:11<00:38,  4.81s/it, loss=0.679, acc=73.5]Training:  68%|██████▊   | 15/22 [01:11<00:32,  4.59s/it, loss=0.679, acc=73.5]Training:  68%|██████▊   | 15/22 [01:16<00:32,  4.59s/it, loss=0.729, acc=73]  Training:  73%|███████▎  | 16/22 [01:16<00:27,  4.58s/it, loss=0.729, acc=73]Training:  73%|███████▎  | 16/22 [01:21<00:27,  4.58s/it, loss=0.719, acc=72.6]Training:  77%|███████▋  | 17/22 [01:21<00:24,  4.80s/it, loss=0.719, acc=72.6]Training:  77%|███████▋  | 17/22 [01:25<00:24,  4.80s/it, loss=0.758, acc=72.4]Training:  82%|████████▏ | 18/22 [01:25<00:18,  4.61s/it, loss=0.758, acc=72.4]Training:  82%|████████▏ | 18/22 [01:30<00:18,  4.61s/it, loss=0.633, acc=72.5]Training:  86%|████████▋ | 19/22 [01:30<00:13,  4.62s/it, loss=0.633, acc=72.5]Training:  86%|████████▋ | 19/22 [01:35<00:13,  4.62s/it, loss=0.792, acc=72]  Training:  91%|█████████ | 20/22 [01:35<00:09,  4.67s/it, loss=0.792, acc=72]Training:  91%|█████████ | 20/22 [01:40<00:09,  4.67s/it, loss=0.772, acc=71.7]Training:  95%|█████████▌| 21/22 [01:40<00:04,  4.71s/it, loss=0.772, acc=71.7]Training:  95%|█████████▌| 21/22 [01:40<00:04,  4.71s/it, loss=0.669, acc=71.7]Training: 100%|██████████| 22/22 [01:40<00:00,  3.39s/it, loss=0.669, acc=71.7]                                                                               Validating:   0%|          | 0/5 [00:00<?, ?it/s]Validating:  20%|██        | 1/5 [00:03<00:14,  3.53s/it]Validating:  40%|████      | 2/5 [00:06<00:09,  3.03s/it]Validating:  60%|██████    | 3/5 [00:09<00:06,  3.18s/it]Validating:  80%|████████  | 4/5 [00:12<00:02,  2.99s/it]Validating: 100%|██████████| 5/5 [00:13<00:00,  2.33s/it]                                                         Train Loss: 0.6587, Train Acc: 71.70%
Val Loss: 0.9508, Val Acc: 66.21%
No improvement for 5 epochs

Epoch 18/50
Training:   0%|          | 0/22 [00:00<?, ?it/s]Training:   0%|          | 0/22 [00:04<?, ?it/s, loss=0.691, acc=65.6]Training:   5%|▍         | 1/22 [00:04<01:43,  4.93s/it, loss=0.691, acc=65.6]Training:   5%|▍         | 1/22 [00:09<01:43,  4.93s/it, loss=0.606, acc=68.8]Training:   9%|▉         | 2/22 [00:09<01:32,  4.62s/it, loss=0.606, acc=68.8]Training:   9%|▉         | 2/22 [00:14<01:32,  4.62s/it, loss=0.689, acc=67.7]Training:  14%|█▎        | 3/22 [00:14<01:34,  4.96s/it, loss=0.689, acc=67.7]Training:  14%|█▎        | 3/22 [00:19<01:34,  4.96s/it, loss=0.993, acc=66.4]Training:  18%|█▊        | 4/22 [00:19<01:25,  4.75s/it, loss=0.993, acc=66.4]Training:  18%|█▊        | 4/22 [00:23<01:25,  4.75s/it, loss=0.552, acc=69.4]Training:  23%|██▎       | 5/22 [00:23<01:21,  4.78s/it, loss=0.552, acc=69.4]Training:  23%|██▎       | 5/22 [00:28<01:21,  4.78s/it, loss=0.736, acc=70.3]Training:  27%|██▋       | 6/22 [00:28<01:15,  4.74s/it, loss=0.736, acc=70.3]Training:  27%|██▋       | 6/22 [00:33<01:15,  4.74s/it, loss=0.557, acc=71.4]Training:  32%|███▏      | 7/22 [00:33<01:12,  4.85s/it, loss=0.557, acc=71.4]Training:  32%|███▏      | 7/22 [00:38<01:12,  4.85s/it, loss=0.54, acc=72.3] Training:  36%|███▋      | 8/22 [00:38<01:06,  4.76s/it, loss=0.54, acc=72.3]Training:  36%|███▋      | 8/22 [00:43<01:06,  4.76s/it, loss=0.782, acc=72.2]Training:  41%|████      | 9/22 [00:43<01:03,  4.89s/it, loss=0.782, acc=72.2]Training:  41%|████      | 9/22 [00:47<01:03,  4.89s/it, loss=0.879, acc=71.2]Training:  45%|████▌     | 10/22 [00:47<00:55,  4.61s/it, loss=0.879, acc=71.2]Training:  45%|████▌     | 10/22 [00:53<00:55,  4.61s/it, loss=0.529, acc=71.9]Training:  50%|█████     | 11/22 [00:53<00:55,  5.03s/it, loss=0.529, acc=71.9]Training:  50%|█████     | 11/22 [00:58<00:55,  5.03s/it, loss=0.468, acc=72.7]Training:  55%|█████▍    | 12/22 [00:58<00:51,  5.18s/it, loss=0.468, acc=72.7]Training:  55%|█████▍    | 12/22 [01:04<00:51,  5.18s/it, loss=0.666, acc=72.4]Training:  59%|█████▉    | 13/22 [01:04<00:48,  5.37s/it, loss=0.666, acc=72.4]Training:  59%|█████▉    | 13/22 [01:08<00:48,  5.37s/it, loss=0.592, acc=72.8]Training:  64%|██████▎   | 14/22 [01:08<00:37,  4.73s/it, loss=0.592, acc=72.8]Training:  64%|██████▎   | 14/22 [01:11<00:37,  4.73s/it, loss=0.926, acc=72.1]Training:  68%|██████▊   | 15/22 [01:11<00:31,  4.45s/it, loss=0.926, acc=72.1]Training:  68%|██████▊   | 15/22 [01:15<00:31,  4.45s/it, loss=0.716, acc=71.9]Training:  73%|███████▎  | 16/22 [01:15<00:25,  4.31s/it, loss=0.716, acc=71.9]Training:  73%|███████▎  | 16/22 [01:20<00:25,  4.31s/it, loss=0.692, acc=71.3]Training:  77%|███████▋  | 17/22 [01:20<00:22,  4.44s/it, loss=0.692, acc=71.3]Training:  77%|███████▋  | 17/22 [01:24<00:22,  4.44s/it, loss=0.616, acc=71.5]Training:  82%|████████▏ | 18/22 [01:24<00:17,  4.37s/it, loss=0.616, acc=71.5]Training:  82%|████████▏ | 18/22 [01:29<00:17,  4.37s/it, loss=0.656, acc=71.4]Training:  86%|████████▋ | 19/22 [01:29<00:13,  4.44s/it, loss=0.656, acc=71.4]Training:  86%|████████▋ | 19/22 [01:34<00:13,  4.44s/it, loss=0.668, acc=71.2]Training:  91%|█████████ | 20/22 [01:34<00:09,  4.55s/it, loss=0.668, acc=71.2]Training:  91%|█████████ | 20/22 [01:38<00:09,  4.55s/it, loss=0.616, acc=71.7]Training:  95%|█████████▌| 21/22 [01:38<00:04,  4.61s/it, loss=0.616, acc=71.7]Training:  95%|█████████▌| 21/22 [01:39<00:04,  4.61s/it, loss=0.429, acc=71.7]Training: 100%|██████████| 22/22 [01:39<00:00,  3.33s/it, loss=0.429, acc=71.7]                                                                               Validating:   0%|          | 0/5 [00:00<?, ?it/s]Validating:  20%|██        | 1/5 [00:03<00:14,  3.52s/it]Validating:  40%|████      | 2/5 [00:06<00:09,  3.05s/it]Validating:  60%|██████    | 3/5 [00:09<00:06,  3.18s/it]Validating:  80%|████████  | 4/5 [00:12<00:03,  3.01s/it]Validating: 100%|██████████| 5/5 [00:13<00:00,  2.35s/it]                                                         Epoch 00018: reducing learning rate of group 0 to 2.5000e-05.
Train Loss: 0.6736, Train Acc: 71.70%
Val Loss: 0.9616, Val Acc: 63.45%
No improvement for 6 epochs

Epoch 19/50
Training:   0%|          | 0/22 [00:00<?, ?it/s]Training:   0%|          | 0/22 [00:04<?, ?it/s, loss=0.652, acc=71.9]Training:   5%|▍         | 1/22 [00:04<01:33,  4.45s/it, loss=0.652, acc=71.9]Training:   5%|▍         | 1/22 [00:09<01:33,  4.45s/it, loss=0.745, acc=71.9]Training:   9%|▉         | 2/22 [00:09<01:31,  4.56s/it, loss=0.745, acc=71.9]Training:   9%|▉         | 2/22 [00:13<01:31,  4.56s/it, loss=0.773, acc=67.7]Training:  14%|█▎        | 3/22 [00:13<01:27,  4.59s/it, loss=0.773, acc=67.7]Training:  14%|█▎        | 3/22 [00:18<01:27,  4.59s/it, loss=0.877, acc=68]  Training:  18%|█▊        | 4/22 [00:18<01:23,  4.65s/it, loss=0.877, acc=68]Training:  18%|█▊        | 4/22 [00:23<01:23,  4.65s/it, loss=0.798, acc=67.5]Training:  23%|██▎       | 5/22 [00:23<01:23,  4.91s/it, loss=0.798, acc=67.5]Training:  23%|██▎       | 5/22 [00:29<01:23,  4.91s/it, loss=0.582, acc=69.3]Training:  27%|██▋       | 6/22 [00:29<01:23,  5.25s/it, loss=0.582, acc=69.3]Training:  27%|██▋       | 6/22 [00:34<01:23,  5.25s/it, loss=0.726, acc=69.2]Training:  32%|███▏      | 7/22 [00:34<01:15,  5.06s/it, loss=0.726, acc=69.2]Training:  32%|███▏      | 7/22 [00:39<01:15,  5.06s/it, loss=0.686, acc=68.4]Training:  36%|███▋      | 8/22 [00:39<01:10,  5.04s/it, loss=0.686, acc=68.4]Training:  36%|███▋      | 8/22 [00:43<01:10,  5.04s/it, loss=0.816, acc=69.1]Training:  41%|████      | 9/22 [00:43<01:02,  4.79s/it, loss=0.816, acc=69.1]Training:  41%|████      | 9/22 [00:47<01:02,  4.79s/it, loss=0.595, acc=69.1]Training:  45%|████▌     | 10/22 [00:47<00:53,  4.47s/it, loss=0.595, acc=69.1]Training:  45%|████▌     | 10/22 [00:53<00:53,  4.47s/it, loss=0.6, acc=69.3]  Training:  50%|█████     | 11/22 [00:53<00:53,  4.90s/it, loss=0.6, acc=69.3]Training:  50%|█████     | 11/22 [00:57<00:53,  4.90s/it, loss=0.552, acc=70.1]Training:  55%|█████▍    | 12/22 [00:57<00:46,  4.68s/it, loss=0.552, acc=70.1]Training:  55%|█████▍    | 12/22 [01:01<00:46,  4.68s/it, loss=0.662, acc=70.2]Training:  59%|█████▉    | 13/22 [01:01<00:41,  4.60s/it, loss=0.662, acc=70.2]Training:  59%|█████▉    | 13/22 [01:06<00:41,  4.60s/it, loss=0.641, acc=70.5]Training:  64%|██████▎   | 14/22 [01:06<00:37,  4.67s/it, loss=0.641, acc=70.5]Training:  64%|██████▎   | 14/22 [01:11<00:37,  4.67s/it, loss=0.532, acc=71.2]Training:  68%|██████▊   | 15/22 [01:11<00:32,  4.59s/it, loss=0.532, acc=71.2]Training:  68%|██████▊   | 15/22 [01:16<00:32,  4.59s/it, loss=0.46, acc=72.1] Training:  73%|███████▎  | 16/22 [01:16<00:28,  4.82s/it, loss=0.46, acc=72.1]Training:  73%|███████▎  | 16/22 [01:21<00:28,  4.82s/it, loss=0.665, acc=71.9]Training:  77%|███████▋  | 17/22 [01:21<00:24,  4.98s/it, loss=0.665, acc=71.9]Training:  77%|███████▋  | 17/22 [01:25<00:24,  4.98s/it, loss=0.542, acc=72]  Training:  82%|████████▏ | 18/22 [01:25<00:18,  4.74s/it, loss=0.542, acc=72]Training:  82%|████████▏ | 18/22 [01:30<00:18,  4.74s/it, loss=0.73, acc=71.7]Training:  86%|████████▋ | 19/22 [01:30<00:14,  4.71s/it, loss=0.73, acc=71.7]Training:  86%|████████▋ | 19/22 [01:35<00:14,  4.71s/it, loss=0.673, acc=71.9]Training:  91%|█████████ | 20/22 [01:35<00:09,  4.68s/it, loss=0.673, acc=71.9]Training:  91%|█████████ | 20/22 [01:39<00:09,  4.68s/it, loss=0.666, acc=71.7]Training:  95%|█████████▌| 21/22 [01:39<00:04,  4.64s/it, loss=0.666, acc=71.7]Training:  95%|█████████▌| 21/22 [01:40<00:04,  4.64s/it, loss=0.498, acc=71.7]Training: 100%|██████████| 22/22 [01:40<00:00,  3.34s/it, loss=0.498, acc=71.7]                                                                               Validating:   0%|          | 0/5 [00:00<?, ?it/s]Validating:  20%|██        | 1/5 [00:03<00:13,  3.48s/it]Validating:  40%|████      | 2/5 [00:06<00:08,  2.97s/it]Validating:  60%|██████    | 3/5 [00:09<00:06,  3.16s/it]Validating:  80%|████████  | 4/5 [00:12<00:03,  3.04s/it]Validating: 100%|██████████| 5/5 [00:13<00:00,  2.37s/it]                                                         Train Loss: 0.6646, Train Acc: 71.70%
Val Loss: 0.9695, Val Acc: 65.52%
No improvement for 7 epochs

Epoch 20/50
Training:   0%|          | 0/22 [00:00<?, ?it/s]Training:   0%|          | 0/22 [00:05<?, ?it/s, loss=0.71, acc=71.9]Training:   5%|▍         | 1/22 [00:05<02:02,  5.84s/it, loss=0.71, acc=71.9]Training:   5%|▍         | 1/22 [00:10<02:02,  5.84s/it, loss=0.919, acc=67.2]Training:   9%|▉         | 2/22 [00:10<01:46,  5.31s/it, loss=0.919, acc=67.2]Training:   9%|▉         | 2/22 [00:14<01:46,  5.31s/it, loss=0.82, acc=66.7] Training:  14%|█▎        | 3/22 [00:14<01:23,  4.39s/it, loss=0.82, acc=66.7]Training:  14%|█▎        | 3/22 [00:19<01:23,  4.39s/it, loss=0.713, acc=67.2]Training:  18%|█▊        | 4/22 [00:19<01:24,  4.72s/it, loss=0.713, acc=67.2]Training:  18%|█▊        | 4/22 [00:23<01:24,  4.72s/it, loss=0.516, acc=69.4]Training:  23%|██▎       | 5/22 [00:23<01:17,  4.58s/it, loss=0.516, acc=69.4]Training:  23%|██▎       | 5/22 [00:28<01:17,  4.58s/it, loss=0.588, acc=70.3]Training:  27%|██▋       | 6/22 [00:28<01:12,  4.54s/it, loss=0.588, acc=70.3]Training:  27%|██▋       | 6/22 [00:33<01:12,  4.54s/it, loss=1.12, acc=66.5] Training:  32%|███▏      | 7/22 [00:33<01:10,  4.72s/it, loss=1.12, acc=66.5]Training:  32%|███▏      | 7/22 [00:38<01:10,  4.72s/it, loss=0.465, acc=69.1]Training:  36%|███▋      | 8/22 [00:38<01:08,  4.87s/it, loss=0.465, acc=69.1]Training:  36%|███▋      | 8/22 [00:43<01:08,  4.87s/it, loss=0.653, acc=69.4]Training:  41%|████      | 9/22 [00:43<01:03,  4.87s/it, loss=0.653, acc=69.4]Training:  41%|████      | 9/22 [00:46<01:03,  4.87s/it, loss=0.627, acc=70.3]Training:  45%|████▌     | 10/22 [00:46<00:53,  4.50s/it, loss=0.627, acc=70.3]Training:  45%|████▌     | 10/22 [00:51<00:53,  4.50s/it, loss=0.537, acc=70.7]Training:  50%|█████     | 11/22 [00:51<00:48,  4.40s/it, loss=0.537, acc=70.7]Training:  50%|█████     | 11/22 [00:55<00:48,  4.40s/it, loss=0.707, acc=70.6]Training:  55%|█████▍    | 12/22 [00:55<00:45,  4.54s/it, loss=0.707, acc=70.6]Training:  55%|█████▍    | 12/22 [01:01<00:45,  4.54s/it, loss=0.425, acc=71.6]Training:  59%|█████▉    | 13/22 [01:01<00:43,  4.86s/it, loss=0.425, acc=71.6]Training:  59%|█████▉    | 13/22 [01:05<00:43,  4.86s/it, loss=0.497, acc=72.1]Training:  64%|██████▎   | 14/22 [01:05<00:36,  4.60s/it, loss=0.497, acc=72.1]Training:  64%|██████▎   | 14/22 [01:11<00:36,  4.60s/it, loss=0.649, acc=72.1]Training:  68%|██████▊   | 15/22 [01:11<00:34,  4.89s/it, loss=0.649, acc=72.1]Training:  68%|██████▊   | 15/22 [01:15<00:34,  4.89s/it, loss=0.472, acc=72.9]Training:  73%|███████▎  | 16/22 [01:15<00:27,  4.64s/it, loss=0.472, acc=72.9]Training:  73%|███████▎  | 16/22 [01:19<00:27,  4.64s/it, loss=0.624, acc=72.8]Training:  77%|███████▋  | 17/22 [01:19<00:23,  4.65s/it, loss=0.624, acc=72.8]Training:  77%|███████▋  | 17/22 [01:24<00:23,  4.65s/it, loss=0.524, acc=73.1]Training:  82%|████████▏ | 18/22 [01:24<00:18,  4.57s/it, loss=0.524, acc=73.1]Training:  82%|████████▏ | 18/22 [01:29<00:18,  4.57s/it, loss=0.907, acc=72.5]Training:  86%|████████▋ | 19/22 [01:29<00:14,  4.87s/it, loss=0.907, acc=72.5]Training:  86%|████████▋ | 19/22 [01:34<00:14,  4.87s/it, loss=0.546, acc=72.7]Training:  91%|█████████ | 20/22 [01:34<00:09,  4.81s/it, loss=0.546, acc=72.7]Training:  91%|█████████ | 20/22 [01:39<00:09,  4.81s/it, loss=0.685, acc=72.3]Training:  95%|█████████▌| 21/22 [01:39<00:04,  4.85s/it, loss=0.685, acc=72.3]Training:  95%|█████████▌| 21/22 [01:40<00:04,  4.85s/it, loss=1.8, acc=72.1]  Training: 100%|██████████| 22/22 [01:40<00:00,  3.67s/it, loss=1.8, acc=72.1]                                                                             Validating:   0%|          | 0/5 [00:00<?, ?it/s]Validating:  20%|██        | 1/5 [00:03<00:14,  3.53s/it]Validating:  40%|████      | 2/5 [00:06<00:09,  3.01s/it]Validating:  60%|██████    | 3/5 [00:09<00:06,  3.16s/it]Validating:  80%|████████  | 4/5 [00:12<00:02,  2.98s/it]Validating: 100%|██████████| 5/5 [00:13<00:00,  2.33s/it]                                                         Train Loss: 0.6576, Train Acc: 72.15%
Val Loss: 0.9474, Val Acc: 66.21%
No improvement for 8 epochs

Epoch 21/50
Training:   0%|          | 0/22 [00:00<?, ?it/s]Training:   0%|          | 0/22 [00:05<?, ?it/s, loss=0.974, acc=59.4]Training:   5%|▍         | 1/22 [00:05<01:54,  5.43s/it, loss=0.974, acc=59.4]Training:   5%|▍         | 1/22 [00:10<01:54,  5.43s/it, loss=0.942, acc=59.4]Training:   9%|▉         | 2/22 [00:10<01:45,  5.27s/it, loss=0.942, acc=59.4]Training:   9%|▉         | 2/22 [00:15<01:45,  5.27s/it, loss=0.753, acc=63.5]Training:  14%|█▎        | 3/22 [00:15<01:34,  4.97s/it, loss=0.753, acc=63.5]Training:  14%|█▎        | 3/22 [00:20<01:34,  4.97s/it, loss=0.49, acc=68]   Training:  18%|█▊        | 4/22 [00:20<01:34,  5.27s/it, loss=0.49, acc=68]Training:  18%|█▊        | 4/22 [00:25<01:34,  5.27s/it, loss=0.538, acc=70.6]Training:  23%|██▎       | 5/22 [00:25<01:22,  4.84s/it, loss=0.538, acc=70.6]Training:  23%|██▎       | 5/22 [00:28<01:22,  4.84s/it, loss=0.503, acc=72.9]Training:  27%|██▋       | 6/22 [00:28<01:12,  4.52s/it, loss=0.503, acc=72.9]Training:  27%|██▋       | 6/22 [00:34<01:12,  4.52s/it, loss=0.464, acc=74.6]Training:  32%|███▏      | 7/22 [00:34<01:11,  4.74s/it, loss=0.464, acc=74.6]Training:  32%|███▏      | 7/22 [00:38<01:11,  4.74s/it, loss=0.623, acc=74.2]Training:  36%|███▋      | 8/22 [00:38<01:04,  4.62s/it, loss=0.623, acc=74.2]Training:  36%|███▋      | 8/22 [00:42<01:04,  4.62s/it, loss=0.476, acc=74.7]Training:  41%|████      | 9/22 [00:42<00:57,  4.46s/it, loss=0.476, acc=74.7]Training:  41%|████      | 9/22 [00:46<00:57,  4.46s/it, loss=0.744, acc=74.4]Training:  45%|████▌     | 10/22 [00:46<00:52,  4.35s/it, loss=0.744, acc=74.4]Training:  45%|████▌     | 10/22 [00:50<00:52,  4.35s/it, loss=0.782, acc=73]  Training:  50%|█████     | 11/22 [00:50<00:45,  4.09s/it, loss=0.782, acc=73]Training:  50%|█████     | 11/22 [00:56<00:45,  4.09s/it, loss=0.668, acc=73.7]Training:  55%|█████▍    | 12/22 [00:56<00:48,  4.87s/it, loss=0.668, acc=73.7]Training:  55%|█████▍    | 12/22 [00:59<00:48,  4.87s/it, loss=0.618, acc=73.6]Training:  59%|█████▉    | 13/22 [00:59<00:38,  4.31s/it, loss=0.618, acc=73.6]Training:  59%|█████▉    | 13/22 [01:05<00:38,  4.31s/it, loss=0.961, acc=72.8]Training:  64%|██████▎   | 14/22 [01:05<00:36,  4.59s/it, loss=0.961, acc=72.8]Training:  64%|██████▎   | 14/22 [01:08<00:36,  4.59s/it, loss=0.481, acc=73.3]Training:  68%|██████▊   | 15/22 [01:08<00:30,  4.36s/it, loss=0.481, acc=73.3]Training:  68%|██████▊   | 15/22 [01:13<00:30,  4.36s/it, loss=0.586, acc=73.2]Training:  73%|███████▎  | 16/22 [01:13<00:26,  4.45s/it, loss=0.586, acc=73.2]Training:  73%|███████▎  | 16/22 [01:17<00:26,  4.45s/it, loss=0.76, acc=72.2] Training:  77%|███████▋  | 17/22 [01:17<00:20,  4.19s/it, loss=0.76, acc=72.2]Training:  77%|███████▋  | 17/22 [01:23<00:20,  4.19s/it, loss=0.8, acc=71.9] Training:  82%|████████▏ | 18/22 [01:23<00:19,  4.80s/it, loss=0.8, acc=71.9]Training:  82%|████████▏ | 18/22 [01:29<00:19,  4.80s/it, loss=0.643, acc=72]Training:  86%|████████▋ | 19/22 [01:29<00:15,  5.05s/it, loss=0.643, acc=72]Training:  86%|████████▋ | 19/22 [01:34<00:15,  5.05s/it, loss=0.753, acc=71.9]Training:  91%|█████████ | 20/22 [01:34<00:10,  5.15s/it, loss=0.753, acc=71.9]Training:  91%|█████████ | 20/22 [01:39<00:10,  5.15s/it, loss=0.558, acc=72.2]Training:  95%|█████████▌| 21/22 [01:39<00:05,  5.02s/it, loss=0.558, acc=72.2]Training:  95%|█████████▌| 21/22 [01:39<00:05,  5.02s/it, loss=0.311, acc=72.3]Training: 100%|██████████| 22/22 [01:39<00:00,  3.74s/it, loss=0.311, acc=72.3]                                                                               Validating:   0%|          | 0/5 [00:00<?, ?it/s]Validating:  20%|██        | 1/5 [00:03<00:13,  3.50s/it]Validating:  40%|████      | 2/5 [00:06<00:08,  2.99s/it]Validating:  60%|██████    | 3/5 [00:09<00:06,  3.14s/it]Validating:  80%|████████  | 4/5 [00:12<00:02,  2.98s/it]Validating: 100%|██████████| 5/5 [00:13<00:00,  2.32s/it]                                                         Train Loss: 0.6706, Train Acc: 72.30%
Val Loss: 0.9051, Val Acc: 65.52%
No improvement for 9 epochs

Epoch 22/50
Training:   0%|          | 0/22 [00:00<?, ?it/s]Training:   0%|          | 0/22 [00:05<?, ?it/s, loss=0.595, acc=78.1]Training:   5%|▍         | 1/22 [00:05<01:46,  5.08s/it, loss=0.595, acc=78.1]Training:   5%|▍         | 1/22 [00:08<01:46,  5.08s/it, loss=0.52, acc=78.1] Training:   9%|▉         | 2/22 [00:08<01:25,  4.30s/it, loss=0.52, acc=78.1]Training:   9%|▉         | 2/22 [00:12<01:25,  4.30s/it, loss=0.623, acc=79.2]Training:  14%|█▎        | 3/22 [00:12<01:15,  3.96s/it, loss=0.623, acc=79.2]Training:  14%|█▎        | 3/22 [00:18<01:15,  3.96s/it, loss=0.734, acc=76.6]Training:  18%|█▊        | 4/22 [00:18<01:25,  4.73s/it, loss=0.734, acc=76.6]Training:  18%|█▊        | 4/22 [00:23<01:25,  4.73s/it, loss=0.684, acc=75.6]Training:  23%|██▎       | 5/22 [00:23<01:21,  4.80s/it, loss=0.684, acc=75.6]Training:  23%|██▎       | 5/22 [00:28<01:21,  4.80s/it, loss=0.64, acc=74]   Training:  27%|██▋       | 6/22 [00:28<01:21,  5.12s/it, loss=0.64, acc=74]Training:  27%|██▋       | 6/22 [00:34<01:21,  5.12s/it, loss=0.702, acc=73.7]Training:  32%|███▏      | 7/22 [00:34<01:19,  5.30s/it, loss=0.702, acc=73.7]Training:  32%|███▏      | 7/22 [00:38<01:19,  5.30s/it, loss=0.788, acc=71.9]Training:  36%|███▋      | 8/22 [00:38<01:07,  4.82s/it, loss=0.788, acc=71.9]Training:  36%|███▋      | 8/22 [00:43<01:07,  4.82s/it, loss=0.556, acc=72.9]Training:  41%|████      | 9/22 [00:43<01:05,  5.01s/it, loss=0.556, acc=72.9]Training:  41%|████      | 9/22 [00:49<01:05,  5.01s/it, loss=1.06, acc=70]   Training:  45%|████▌     | 10/22 [00:49<01:01,  5.10s/it, loss=1.06, acc=70]Training:  45%|████▌     | 10/22 [00:53<01:01,  5.10s/it, loss=0.864, acc=68.5]Training:  50%|█████     | 11/22 [00:53<00:53,  4.83s/it, loss=0.864, acc=68.5]Training:  50%|█████     | 11/22 [00:58<00:53,  4.83s/it, loss=0.566, acc=69.8]Training:  55%|█████▍    | 12/22 [00:58<00:49,  4.92s/it, loss=0.566, acc=69.8]Training:  55%|█████▍    | 12/22 [01:03<00:49,  4.92s/it, loss=0.548, acc=70.7]Training:  59%|█████▉    | 13/22 [01:03<00:43,  4.82s/it, loss=0.548, acc=70.7]Training:  59%|█████▉    | 13/22 [01:07<00:43,  4.82s/it, loss=0.4, acc=71.7]  Training:  64%|██████▎   | 14/22 [01:07<00:38,  4.84s/it, loss=0.4, acc=71.7]Training:  64%|██████▎   | 14/22 [01:11<00:38,  4.84s/it, loss=0.692, acc=71.2]Training:  68%|██████▊   | 15/22 [01:11<00:30,  4.42s/it, loss=0.692, acc=71.2]Training:  68%|██████▊   | 15/22 [01:15<00:30,  4.42s/it, loss=0.719, acc=70.9]Training:  73%|███████▎  | 16/22 [01:15<00:25,  4.25s/it, loss=0.719, acc=70.9]Training:  73%|███████▎  | 16/22 [01:20<00:25,  4.25s/it, loss=0.662, acc=71.3]Training:  77%|███████▋  | 17/22 [01:20<00:22,  4.51s/it, loss=0.662, acc=71.3]Training:  77%|███████▋  | 17/22 [01:24<00:22,  4.51s/it, loss=0.586, acc=71.4]Training:  82%|████████▏ | 18/22 [01:24<00:17,  4.33s/it, loss=0.586, acc=71.4]Training:  82%|████████▏ | 18/22 [01:28<00:17,  4.33s/it, loss=0.687, acc=71.1]Training:  86%|████████▋ | 19/22 [01:28<00:12,  4.30s/it, loss=0.687, acc=71.1]Training:  86%|████████▋ | 19/22 [01:33<00:12,  4.30s/it, loss=0.47, acc=71.9] Training:  91%|█████████ | 20/22 [01:33<00:08,  4.41s/it, loss=0.47, acc=71.9]Training:  91%|█████████ | 20/22 [01:37<00:08,  4.41s/it, loss=0.557, acc=72.3]Training:  95%|█████████▌| 21/22 [01:37<00:04,  4.50s/it, loss=0.557, acc=72.3]Training:  95%|█████████▌| 21/22 [01:38<00:04,  4.50s/it, loss=0.261, acc=72.4]Training: 100%|██████████| 22/22 [01:38<00:00,  3.24s/it, loss=0.261, acc=72.4]                                                                               Validating:   0%|          | 0/5 [00:00<?, ?it/s]Validating:  20%|██        | 1/5 [00:03<00:13,  3.47s/it]Validating:  40%|████      | 2/5 [00:06<00:08,  2.97s/it]Validating:  60%|██████    | 3/5 [00:09<00:06,  3.14s/it]Validating:  80%|████████  | 4/5 [00:12<00:02,  2.96s/it]Validating: 100%|██████████| 5/5 [00:13<00:00,  2.30s/it]                                                         Train Loss: 0.6482, Train Acc: 72.44%
Val Loss: 0.9027, Val Acc: 66.21%
No improvement for 10 epochs

Early stopping triggered after 22 epochs

Training history saved to /app/output/training_history.csv
Training config saved to /app/output/training_config.json

Training completed!
Best validation accuracy: 70.34%
Model saved to /app/output/models/best_model.pth

Step 3: Running evaluation...

============================================================
EVALUATION
============================================================

[Device Information]
  Using: CPU

Loading model...
Model loaded from /app/output/models/best_model.pth
  Checkpoint epoch: 12
  Checkpoint val_acc: 70.34%

Test set size: 145

Running inference on test set...
Running inference:   0%|          | 0/5 [00:00<?, ?it/s]Running inference:  20%|██        | 1/5 [00:04<00:16,  4.10s/it]Running inference:  40%|████      | 2/5 [00:06<00:09,  3.24s/it]Running inference:  60%|██████    | 3/5 [00:10<00:07,  3.59s/it]Running inference:  80%|████████  | 4/5 [00:13<00:03,  3.43s/it]Running inference: 100%|██████████| 5/5 [00:15<00:00,  2.64s/it]Running inference: 100%|██████████| 5/5 [00:15<00:00,  3.04s/it]

Computing metrics...

============================================================
EVALUATION RESULTS
============================================================

Overall Accuracy: 73.10%

Macro-averaged Metrics:
  Precision: 51.11%
  Recall: 44.67%
  F1-Score: 44.55%

Per-class Metrics:

  Pronacio:
    Precision: 81.25%
    Recall: 37.14%
    F1-Score: 50.98%

  Neutralis:
    Precision: 72.09%
    Recall: 96.88%
    F1-Score: 82.67%

  Szupinacio:
    Precision: 0.00%
    Recall: 0.00%
    F1-Score: 0.00%

============================================================
Classification Report:
              precision    recall  f1-score   support

    Pronacio       0.81      0.37      0.51        35
   Neutralis       0.72      0.97      0.83        96
  Szupinacio       0.00      0.00      0.00        14

    accuracy                           0.73       145
   macro avg       0.51      0.45      0.45       145
weighted avg       0.67      0.73      0.67       145

Confusion matrix saved to /app/output/confusion_matrix.png
Normalized confusion matrix saved to /app/output/confusion_matrix_normalized.png

Evaluation report saved to /app/output/evaluation_report.json
Test predictions saved to /app/output/test_predictions.csv

============================================================
Evaluation completed successfully!
============================================================

Step 4: Running inference...

============================================================
INFERENCE
============================================================

[Device Information]
  Using: CPU

Loading model...
Model loaded from /app/output/models/best_model.pth
  Checkpoint epoch: 12
  Checkpoint val_acc: 70.34%

No inference images found in /data/inference
To run inference on new images:
  1. Create a directory: /data/inference
  2. Place your images in that directory
  3. Run this script again

Running demo inference on sample test images...

[Demo Inference Results]
------------------------------------------------------------

Image: sajat_reszvevo03_01.JPG
  Predicted: Neutralis
  Confidence: 78.3%
  All probabilities:
    Pronacio: 14.3%
    Neutralis: 78.3%
    Szupinacio: 7.4%

Image: sajat_reszvevo07_01.jpg
  Predicted: Neutralis
  Confidence: 77.0%
  All probabilities:
    Pronacio: 22.7%
    Neutralis: 77.0%
    Szupinacio: 0.3%

Image: sajat_resztvevo03_01.jpg
  Predicted: Neutralis
  Confidence: 95.4%
  All probabilities:
    Pronacio: 4.3%
    Neutralis: 95.4%
    Szupinacio: 0.3%

Image: sajat_reszvevo02_05.jpg
  Predicted: Neutralis
  Confidence: 92.0%
  All probabilities:
    Pronacio: 3.4%
    Neutralis: 92.0%
    Szupinacio: 4.6%

Image: sajat_reszvevo_04_04.jpg
  Predicted: Neutralis
  Confidence: 85.8%
  All probabilities:
    Pronacio: 1.6%
    Neutralis: 85.8%
    Szupinacio: 12.7%

==========================================
Pipeline finished successfully.
==========================================
